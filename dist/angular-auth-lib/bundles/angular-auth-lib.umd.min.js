!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/common/http"),require("rxjs/operators"),require("@angular/common"),require("@angular/router"),require("@ngrx/store"),require("@angular/forms"),require("lodash-es/get"),require("@angular/material/dialog"),require("@angular/material/input"),require("@angular/material/card"),require("@angular/material/button"),require("@angular/material/progress-spinner"),require("@angular/platform-browser/animations"),require("@ngrx/effects"),require("ngx-toastr"),require("rxjs")):"function"==typeof define&&define.amd?define("angular-auth-lib",["exports","@angular/core","@angular/common/http","rxjs/operators","@angular/common","@angular/router","@ngrx/store","@angular/forms","lodash-es/get","@angular/material/dialog","@angular/material/input","@angular/material/card","@angular/material/button","@angular/material/progress-spinner","@angular/platform-browser/animations","@ngrx/effects","ngx-toastr","rxjs"],e):e((t=t||self)["angular-auth-lib"]={},t.ng.core,t.ng.common.http,t.rxjs.operators,t.ng.common,t.ng.router,t["@ngrx/store"],t.ng.forms,t.get,t.ng.material.dialog,t.ng.material.input,t.ng.material.card,t.ng.material.button,t.ng.material.progressSpinner,t.ng.platformBrowser.animations,t["@ngrx/effects"],t["ngx-toastr"],t.rxjs)}(this,(function(t,e,r,o,n,s,i,a,u,c,l,p,d,h,f,m,g,S){"use strict";u=u&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u;var T=function(){return(T=Object.assign||function(t){for(var e,r=1,o=arguments.length;r<o;r++)for(var n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)};function _(t,e,r,o){var n,s=arguments.length,i=s<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,r,o);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(i=(s<3?n(i):s>3?n(e,r,i):n(e,r))||i);return s>3&&i&&Object.defineProperty(e,r,i),i}function A(t,e){return function(r,o){e(r,o,t)}}function I(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,s=r.call(t),i=[];try{for(;(void 0===e||e-- >0)&&!(o=s.next()).done;)i.push(o.value)}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return i}var P,y=new e.InjectionToken("Auth api related urls"),U=new e.InjectionToken("Images urls"),C=new e.InjectionToken("Traductions"),O=new e.InjectionToken("Reset actions"),E=new e.InjectionToken("Styling"),N=function(){function t(t,e,r){this.apiUrls=t,this.platformId=e,this.http=r}return t.prototype.decodeToken=function(t){var e=t.split(/\./),r=JSON.parse(window.atob(e[1]));return{token:t,expiringDate:new Date(1e3*r.exp)}},t.prototype.getToken=function(){var t=n.isPlatformBrowser(this.platformId)?sessionStorage.getItem("token"):null;return t?this.decodeToken(t):null},t.prototype.getAccessToken=function(t){var e=this,r={username:t.username,password:t.password};return this.http.post(this.apiUrls.accessTokenUrl,r).pipe(o.map((function(t){return e.decodeToken(t.access)})))},t.prototype.getRefreshToken=function(t){var e=this,r={refresh:t.token};return this.http.post(this.apiUrls.refreshTokenUrl,r).pipe(o.map((function(t){return e.decodeToken(t.access)})))},t.prototype.login=function(t){return this.getAccessToken(t).pipe(o.map((function(e){return T(T({},t),{token:e})})))},t.prototype.getUserInformation=function(){return this.http.get(this.apiUrls.userInformationUrl).pipe(o.map((function(t){return{usersList:t.usersList,user:T(T({},t.user),{dateJoined:new Date(t.user.dateJoined)})}})))},t.prototype.changePassword=function(t){return this.http.put(this.apiUrls.changePasswordUrl,t)},t.prototype.sendPassword=function(t){return this.http.post(this.apiUrls.sendBackPasswordUrl,{email:t})},t.prototype.createUser=function(t){return this.http.post(this.apiUrls.signUpUrl,t)},t.ctorParameters=function(){return[{type:void 0,decorators:[{type:e.Inject,args:[y]}]},{type:void 0,decorators:[{type:e.Inject,args:[e.PLATFORM_ID]}]},{type:r.HttpClient}]},t.ɵprov=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject(y),e.ɵɵinject(e.PLATFORM_ID),e.ɵɵinject(r.HttpClient))},token:t,providedIn:"root"}),t=_([e.Injectable({providedIn:"root"}),A(0,e.Inject(y)),A(1,e.Inject(e.PLATFORM_ID))],t)}(),w=i.createFeatureSelector("auth"),v=function(t){return t.isAuthenticated},L=i.createSelector(w,v),b=function(t){return t.error},R=i.createSelector(w,b),D=function(t){return t.user},F=i.createSelector(w,D),H=function(t){return t.isPasswordBeingChanged},j=i.createSelector(w,H),x=function(t){return t.usersList},k=i.createSelector(w,x),G=function(t){return t.isSignUpLoading},Y=i.createSelector(w,G),B=function(t){return t.isLoginLoading},M=i.createSelector(w,B),$=function(){function t(t,e,r){this.store=t,this.router=e,this.platformId=r}return t.prototype.canActivate=function(t,e){var r=this;return this.store.pipe(i.select(F),o.withLatestFrom(this.store.pipe(i.select(L))),o.map((function(o){var s=I(o,2),i=s[0],a=s[1];return!!(i&&i.allowedUrls.includes(t.routeConfig.path)&&a)||(i&&i.allowedUrls.includes(t.routeConfig.path)&&n.isPlatformBrowser(r.platformId)&&sessionStorage.setItem("redirectedUrlAfterLogIn",e.url),r.router.navigate(["log-in"]),!1)})))},t.ctorParameters=function(){return[{type:i.Store},{type:s.Router},{type:void 0,decorators:[{type:e.Inject,args:[e.PLATFORM_ID]}]}]},t.ɵprov=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject(i.Store),e.ɵɵinject(s.Router),e.ɵɵinject(e.PLATFORM_ID))},token:t,providedIn:"root"}),t=_([e.Injectable({providedIn:"root"}),A(2,e.Inject(e.PLATFORM_ID))],t)}(),W=function(){function t(t){this.authService=t}return t.prototype.intercept=function(t,e){var r=this.authService.getToken();return r&&(t=t.clone({setHeaders:{Authorization:"Bearer "+r.token}})),e.handle(t)},t.ctorParameters=function(){return[{type:N}]},t=_([e.Injectable()],t)}();(P=t.AUTH_ACTIONS_TYPE||(t.AUTH_ACTIONS_TYPE={})).OPEN_SIGN_UP_DIALOG="[Auth] User wants to sign up",P.SIGN_UP="[Auth] User tries to sign up",P.SIGN_UP_SUCCESS="[Auth] Sign up success",P.SIGN_UP_FAILURE="[Auth] Sign up failure",P.LOG_IN="[Auth] User tries to log in",P.LOG_IN_SUCCESS="[Auth] Log in success",P.LOG_IN_FAILURE="[Auth] Log in failure",P.LOG_OUT="[Auth] User logs out",P.LOAD_USER_INFORMATION="[Auth] Loading of user information",P.LOAD_USER_INFORMATION_SUCCESS="[Auth] Loading of user information success",P.LOAD_USER_INFORMATION_FAILURE="[Auth] Loading of user information failure",P.CHANGE_PASSWORD="[Auth] User changes his password",P.CHANGE_PASSWORD_SUCCESS="[Auth] Password change success",P.CHANGE_PASSWORD_FAILURE="[Auth] Password change failure",P.OPEN_FORGOTTEN_PASSWORD_DIALOG="[Auth] User opens dialog for password resetting",P.SEND_PASSWORD="[Auth] User has asked for having back a new password",P.SEND_PASSWORD_SUCCESS="[Auth] User has received his password",P.SEND_PASSWORD_FAILURE="[Auth] Error in the process of sending the password to the user",P.UPDATE_USER="[Auth] Update of user";var q=function(){this.type=t.AUTH_ACTIONS_TYPE.OPEN_SIGN_UP_DIALOG},V=function(e){this.payload=e,this.type=t.AUTH_ACTIONS_TYPE.SIGN_UP},z=function(){this.type=t.AUTH_ACTIONS_TYPE.SIGN_UP_SUCCESS},J=function(e){this.payload=e,this.type=t.AUTH_ACTIONS_TYPE.SIGN_UP_FAILURE},K=function(e){this.payload=e,this.type=t.AUTH_ACTIONS_TYPE.LOG_IN},Q=function(e){this.payload=e,this.type=t.AUTH_ACTIONS_TYPE.LOG_IN_SUCCESS},X=function(e){this.payload=e,this.type=t.AUTH_ACTIONS_TYPE.LOG_IN_FAILURE},Z=function(){this.type=t.AUTH_ACTIONS_TYPE.LOG_OUT},tt=function(){this.type=t.AUTH_ACTIONS_TYPE.LOAD_USER_INFORMATION},et=function(e){this.payload=e,this.type=t.AUTH_ACTIONS_TYPE.LOAD_USER_INFORMATION_SUCCESS},rt=function(e){this.payload=e,this.type=t.AUTH_ACTIONS_TYPE.LOAD_USER_INFORMATION_FAILURE},ot=function(e){this.payload=e,this.type=t.AUTH_ACTIONS_TYPE.CHANGE_PASSWORD},nt=function(){this.type=t.AUTH_ACTIONS_TYPE.CHANGE_PASSWORD_SUCCESS},st=function(e){this.payload=e,this.type=t.AUTH_ACTIONS_TYPE.CHANGE_PASSWORD_FAILURE},it=function(){this.type=t.AUTH_ACTIONS_TYPE.OPEN_FORGOTTEN_PASSWORD_DIALOG},at=function(e){this.payload=e,this.type=t.AUTH_ACTIONS_TYPE.SEND_PASSWORD},ut=function(){this.type=t.AUTH_ACTIONS_TYPE.SEND_PASSWORD_SUCCESS},ct=function(e){this.payload=e,this.type=t.AUTH_ACTIONS_TYPE.SEND_PASSWORD_FAILURE},lt=function(e){this.payload=e,this.type=t.AUTH_ACTIONS_TYPE.UPDATE_USER},pt=function(){function t(t,e,r,o,n){this.images=t,this.traductions=e,this.styles=r,this.formBuilder=o,this.store=n,this.isPasswordBeingChanged$=this.store.pipe(i.select(j)),this.isLoginLoading$=this.store.pipe(i.select(M)),this.usernamePlaceholder="Username",this.passwordPlaceholder="Password",this.forgottenPassword="Forgot your password?",this.loginButtonTraduction="Log in",this.buttonsBackgroundColor="#3f51b5",this.buttonsColor="white"}return t.prototype.ngOnInit=function(){this.usernamePlaceholder=u(this.traductions||{},"form.usernamePlaceholder",this.usernamePlaceholder),this.passwordPlaceholder=u(this.traductions||{},"form.passwordPlaceholder",this.passwordPlaceholder),this.forgottenPassword=u(this.traductions||{},"buttons.passwordForgotten",this.forgottenPassword),this.loginButtonTraduction=u(this.traductions||{},"buttons.login",this.loginButtonTraduction),this.buttonsBackgroundColor=u(this.styles||{},"buttonsBackgroundColor",this.buttonsBackgroundColor),this.buttonsColor=u(this.styles||{},"buttonsColor",this.buttonsColor),this.userForm=this.formBuilder.group({username:["",a.Validators.required],password:["",a.Validators.required]})},t.prototype.openDialog=function(){this.store.dispatch(new it)},t.prototype.onSubmit=function(){var t={username:this.userForm.value.username,password:this.userForm.value.password};this.store.dispatch(new K(t))},t.ctorParameters=function(){return[{type:void 0,decorators:[{type:e.Inject,args:[U]}]},{type:void 0,decorators:[{type:e.Inject,args:[C]}]},{type:void 0,decorators:[{type:e.Inject,args:[E]}]},{type:a.FormBuilder},{type:i.Store}]},t=_([e.Component({selector:"auth-lib-log-in",template:'<div id="container" [ngStyle]="{\'background-image\': \'url(\' + images.loginBackgroundImageUrl + \')\'}">\n  <mat-card class="mat-elevation-z8">\n    <img *ngIf="images.logoImageUrl && images.logoImageUrl.length >= 1" [src]="images.logoImageUrl">\n    <form [formGroup]="userForm" (ngSubmit)="onSubmit()">\n\n      <mat-form-field>\n        <input matInput [placeholder]="usernamePlaceholder" formControlName="username">\n      </mat-form-field>\n\n      <mat-form-field>\n          <input matInput type="password" [placeholder]="passwordPlaceholder" formControlName="password">\n      </mat-form-field>\n\n      <button \n        mat-raised-button\n        type="submit" \n        [disabled]="userForm.invalid"\n        *ngIf="!(isPasswordBeingChanged$ | async) && !(isLoginLoading$ | async)"\n        [ngStyle]="{\n          \'background-color\': buttonsBackgroundColor,\n          \'color\': buttonsColor\n        }"\n      >\n        {{ loginButtonTraduction }}\n      </button>\n      <mat-spinner *ngIf="(isPasswordBeingChanged$ | async) || (isLoginLoading$ | async)" [diameter]="36"></mat-spinner>\n\n      <a (click)="openDialog()">{{ forgottenPassword }}</a>\n    </form>\n  </mat-card>\n</div>\n',styles:["#container{display:flex;flex-direction:column;justify-content:center;align-items:center;height:100%;width:100%;flex:1;background-size:cover}#container mat-card{display:flex;flex-direction:column;justify-content:center;align-items:center;height:400px;width:400px;box-sizing:border-box;padding:2%}#container mat-card img{display:block;max-width:200px;max-height:100px;width:auto;height:auto;margin-bottom:20px}#container mat-card form{display:flex;flex:1;flex-direction:column;justify-content:center;align-items:center;width:100%}#container mat-card form mat-form-field{width:75%;font-size:16px}#container mat-card form a,#container mat-card form button,#container mat-card form mat-spinner{margin-top:20px}#container mat-card form a{cursor:pointer;color:#1e90ff;font-size:16px}"]}),A(0,e.Inject(U)),A(1,e.Inject(C)),A(2,e.Inject(E))],t)}(),dt=function(){function t(t,e,r){this.store=t,this.traductions=e,this.styles=r,this.emailPlaceholder="Your email",this.sendButtonTraduction="Send",this.buttonsBackgroundColor="#3f51b5",this.buttonsColor="white"}return t.prototype.ngOnInit=function(){this.emailPlaceholder=u(this.traductions||{},"form.emailPlaceholder",this.emailPlaceholder),this.sendButtonTraduction=u(this.traductions||{},"buttons.send",this.sendButtonTraduction),this.buttonsBackgroundColor=u(this.styles||{},"buttonsBackgroundColor",this.buttonsBackgroundColor),this.buttonsColor=u(this.styles||{},"buttonsColor",this.buttonsColor)},t.prototype.send=function(){this.store.dispatch(new at(this.emailInput.nativeElement.value))},t.ctorParameters=function(){return[{type:i.Store},{type:void 0,decorators:[{type:e.Inject,args:[C]}]},{type:void 0,decorators:[{type:e.Inject,args:[E]}]}]},_([e.ViewChild("email")],t.prototype,"emailInput",void 0),t=_([e.Component({selector:"auth-lib-forgotten-password",template:'<mat-form-field>\n  <input matInput [placeholder]="emailPlaceholder" #email>\n</mat-form-field>\n\n<button \n  mat-raised-button\n  type="button" \n  (click)="send()" \n  [disabled]="!(this.emailInput && this.emailInput.nativeElement && this.emailInput.nativeElement.value)"\n  [ngStyle]="{\n    \'background-color\': buttonsBackgroundColor,\n    \'color\': buttonsColor\n  }"\n>\n  {{ sendButtonTraduction }}\n</button>\n',styles:["mat-form-field{font-size:12px;margin-right:30px;width:230px}"]}),A(1,e.Inject(C)),A(2,e.Inject(E))],t)}(),ht=function(){function t(t,e,r,o,n){this.traductions=t,this.styles=e,this.dialogRef=r,this.formBuilder=o,this.store=n,this.usernamePlaceholder="Username",this.passwordPlaceholder="Password",this.firstNamePlaceholder="First name",this.lastNamePlaceholder="Last name",this.emailPlaceholder="Email",this.enterprisePlaceholder="Enterprise",this.signUpDialogTitle="Sign Up",this.signupButtonTraduction="Log in",this.buttonsBackgroundColor="#3f51b5",this.buttonsColor="white"}return t.prototype.ngOnInit=function(){this.usernamePlaceholder=u(this.traductions||{},"form.usernamePlaceholder",this.usernamePlaceholder),this.passwordPlaceholder=u(this.traductions||{},"form.passwordPlaceholder",this.passwordPlaceholder),this.firstNamePlaceholder=u(this.traductions||{},"form.firstNamePlaceholder",this.firstNamePlaceholder),this.lastNamePlaceholder=u(this.traductions||{},"form.lastNamePlaceholder",this.lastNamePlaceholder),this.emailPlaceholder=u(this.traductions||{},"form.emailPlaceholder",this.emailPlaceholder),this.enterprisePlaceholder=u(this.traductions||{},"form.enterprisePlaceholder",this.enterprisePlaceholder),this.signUpDialogTitle=u(this.traductions||{},"dialogs.signup",this.signUpDialogTitle),this.signupButtonTraduction=u(this.traductions||{},"buttons.signup",this.signupButtonTraduction),this.buttonsBackgroundColor=u(this.styles||{},"buttonsBackgroundColor",this.buttonsBackgroundColor),this.buttonsColor=u(this.styles||{},"buttonsColor",this.buttonsColor),this.userForm=this.formBuilder.group({username:["",a.Validators.required],password:["",a.Validators.required],firstName:["",a.Validators.required],lastName:["",a.Validators.required],email:["",a.Validators.required],enterprise:""})},t.prototype.onSubmit=function(){var t={username:this.userForm.value.username,password:this.userForm.value.password,firstName:this.userForm.value.firstName,lastName:this.userForm.value.lastName,email:this.userForm.value.email,enterprise:this.userForm.value.enterprise||null};this.store.dispatch(new V(t)),this.dialogRef.close()},t.ctorParameters=function(){return[{type:void 0,decorators:[{type:e.Inject,args:[C]}]},{type:void 0,decorators:[{type:e.Inject,args:[E]}]},{type:c.MatDialogRef},{type:a.FormBuilder},{type:i.Store}]},t=_([e.Component({selector:"auth-lib-sign-up",template:'<div id="container">\n    <h2 mat-dialog-title>{{ signUpDialogTitle }}</h2>\n    <form [formGroup]="userForm" (ngSubmit)="onSubmit()">\n\n        <div id="columns">\n            <div id="left-column">\n                <mat-form-field>\n                    <input matInput [placeholder]="usernamePlaceholder" formControlName="username" autocomplete="off">\n                </mat-form-field>\n                <mat-form-field>\n                    <input matInput [placeholder]="firstNamePlaceholder" formControlName="firstName" autocomplete="off">\n                </mat-form-field>\n                <mat-form-field>\n                    <input matInput [placeholder]="emailPlaceholder" formControlName="email" autocomplete="off">\n                </mat-form-field>\n            </div>\n\n            <div id="right-column">\n                <mat-form-field>\n                    <input matInput type="password" [placeholder]="passwordPlaceholder" formControlName="password" autocomplete="off">\n                </mat-form-field>\n                <mat-form-field>\n                    <input matInput [placeholder]="lastNamePlaceholder" formControlName="lastName" autocomplete="off">\n                </mat-form-field>\n                <mat-form-field>\n                    <input matInput [placeholder]="enterprisePlaceholder" formControlName="enterprise" autocomplete="off">\n                </mat-form-field>\n            </div>\n        </div>\n\n        <button mat-raised-button type="submit" [disabled]="userForm.invalid" [ngStyle]="{\n            \'background-color\': buttonsBackgroundColor,\n            \'color\': buttonsColor\n          }">\n            {{ signupButtonTraduction }}\n        </button>\n    </form>\n</div>\n',styles:["#container{display:flex;flex-direction:column;width:600px}#container form{margin-top:20px;display:flex;flex-direction:column;justify-content:space-between}#container form #columns{display:flex;flex-direction:row;justify-content:space-between}#container form #columns #left-column{margin-right:20px}#container form #columns #left-column,#container form #columns #right-column{display:flex;flex-direction:column;justify-content:space-between;width:100%}#container form #columns mat-form-field{width:100%}#container button{margin-top:20px;-ms-grid-row-align:center;align-self:center}"]}),A(0,e.Inject(C)),A(1,e.Inject(E))],t)}(),ft={isAuthenticated:!1,isSignUpLoading:!1,isLoginLoading:!1,user:null,error:null,isPasswordBeingChanged:!1,usersList:null};function mt(e,r){switch(void 0===e&&(e=ft),r.type){case t.AUTH_ACTIONS_TYPE.SIGN_UP:return T(T({},e),{error:null,isSignUpLoading:!0});case t.AUTH_ACTIONS_TYPE.SIGN_UP_FAILURE:return T(T({},e),{error:r.payload,isSignUpLoading:!1});case t.AUTH_ACTIONS_TYPE.SIGN_UP_SUCCESS:return T(T({},e),{error:null,isSignUpLoading:!1});case t.AUTH_ACTIONS_TYPE.LOG_IN:return T(T({},e),{error:null,isLoginLoading:!0});case t.AUTH_ACTIONS_TYPE.LOG_IN_SUCCESS:return T(T({},e),{isAuthenticated:!0,user:r.payload.user,error:null,usersList:r.payload.usersList,isLoginLoading:!1});case t.AUTH_ACTIONS_TYPE.LOG_IN_FAILURE:return T(T({},e),{error:r.payload,isLoginLoading:!1});case t.AUTH_ACTIONS_TYPE.LOG_OUT:return ft;case t.AUTH_ACTIONS_TYPE.LOAD_USER_INFORMATION_SUCCESS:var o=T(T({},e.user),r.payload);return T(T({},e),{user:o});case t.AUTH_ACTIONS_TYPE.CHANGE_PASSWORD:case t.AUTH_ACTIONS_TYPE.SEND_PASSWORD:return T(T({},e),{isPasswordBeingChanged:!0});case t.AUTH_ACTIONS_TYPE.CHANGE_PASSWORD_SUCCESS:case t.AUTH_ACTIONS_TYPE.CHANGE_PASSWORD_FAILURE:case t.AUTH_ACTIONS_TYPE.SEND_PASSWORD_SUCCESS:case t.AUTH_ACTIONS_TYPE.SEND_PASSWORD_FAILURE:return T(T({},e),{isPasswordBeingChanged:!1});case t.AUTH_ACTIONS_TYPE.UPDATE_USER:return T(T({},e),{user:T(T({},e.user),r.payload)});default:return e}}var gt=function(){function r(e,r,s,a,c,l,p,d,h){var f=this;this.resetActions=e,this.traductions=r,this.platformId=s,this.actions=a,this.authService=c,this.router=l,this.toastService=p,this.dialog=d,this.store=h,this.OpenSignUpDialog$=this.actions.pipe(m.ofType(t.AUTH_ACTIONS_TYPE.OPEN_SIGN_UP_DIALOG),o.tap((function(){return f.dialogRef=f.dialog.open(ht)}))),this.SignUp$=this.actions.pipe(m.ofType(t.AUTH_ACTIONS_TYPE.SIGN_UP),o.map((function(t){return t.payload})),o.switchMap((function(t){return f.authService.createUser(t).pipe(o.map((function(){return new z})),o.catchError((function(t){return S.of(new J(t))})))}))),this.SignUpSuccess$=this.actions.pipe(m.ofType(t.AUTH_ACTIONS_TYPE.SIGN_UP_SUCCESS),o.tap((function(){f.toastService.success(u(f.traductions||{},"messages.signupSuccess","Your account has been created!"))}))),this.SignUpFailure$=this.actions.pipe(m.ofType(t.AUTH_ACTIONS_TYPE.SIGN_UP_FAILURE),o.tap((function(t){return f.toastService.error(u(f.traductions||{},"messages.signupFailure","Please try again with a new username."))}))),this.LogIn$=this.actions.pipe(m.ofType(t.AUTH_ACTIONS_TYPE.LOG_IN),o.filter((function(t){return n.isPlatformBrowser(f.platformId)})),o.map((function(t){return t.payload})),o.switchMap((function(t){return f.authService.login(t).pipe(o.concatMap((function(t){return sessionStorage.setItem("token",t.token.token),f.authService.getUserInformation().pipe(o.map((function(t){var e=t.user,r=t.usersList;return new Q({user:e,usersList:r})})),o.catchError((function(t){return S.of(new X(t))})))})),o.catchError((function(t){return S.of(new X(t))})))}))),this.LogInSuccess$=this.actions.pipe(m.ofType(t.AUTH_ACTIONS_TYPE.LOG_IN_SUCCESS),o.filter((function(t){return n.isPlatformBrowser(f.platformId)})),o.withLatestFrom(this.store.pipe(i.select(F))),o.tap((function(t){var e=I(t,2),r=(e[0],e[1]),o=sessionStorage.getItem("redirectedUrlAfterLogIn");o&&n.isPlatformBrowser(f.platformId)?(f.router.navigateByUrl(o),sessionStorage.removeItem("redirectedUrlAfterLogIn")):f.router.navigateByUrl(r.redirectUrlAfterLogin),f.toastService.success(u(f.traductions||{},"messages.loginSuccess","Hi! Nice to see you again!"))}))),this.LogInFailure$=this.actions.pipe(m.ofType(t.AUTH_ACTIONS_TYPE.LOG_IN_FAILURE),o.tap((function(t){return f.toastService.error(u(f.traductions||{},"messages.loginFailure","Wrong credentials. Please check again."))}))),this.LogOut$=this.actions.pipe(m.ofType(t.AUTH_ACTIONS_TYPE.LOG_OUT),o.filter((function(t){return n.isPlatformBrowser(f.platformId)})),o.switchMap((function(t){return sessionStorage.removeItem("token"),f.router.navigate(["log-in"]),(f.resetActions||[]).map((function(t){return new t}))}))),this.LoadUserInformation$=this.actions.pipe(m.ofType(t.AUTH_ACTIONS_TYPE.LOAD_USER_INFORMATION),o.switchMap((function(t){return f.authService.getUserInformation().pipe(o.map((function(t){var e=t.user;t.usersList;return new et(e)})),o.catchError((function(t){return S.of(new rt(t))})))}))),this.ChangePassword$=this.actions.pipe(m.ofType(t.AUTH_ACTIONS_TYPE.CHANGE_PASSWORD),o.switchMap((function(t){return f.authService.changePassword(t.payload).pipe(o.map((function(){return new nt})),o.catchError((function(t){return S.of(new st(t))})))}))),this.ChangePasswordSuccess$=this.actions.pipe(m.ofType(t.AUTH_ACTIONS_TYPE.CHANGE_PASSWORD_SUCCESS),o.tap((function(){return f.toastService.success(u(f.traductions||{},"messages.changePasswordSuccess","Your password has been successfully changed!"))}))),this.ChangePasswordFailure$=this.actions.pipe(m.ofType(t.AUTH_ACTIONS_TYPE.CHANGE_PASSWORD_FAILURE),o.tap((function(t){return f.toastService.error(u(f.traductions||{},"messages.changePasswordFailure","Wrong current password. Please try again."))}))),this.OpenForgottenPasswordDialog$=this.actions.pipe(m.ofType(t.AUTH_ACTIONS_TYPE.OPEN_FORGOTTEN_PASSWORD_DIALOG),o.tap((function(){return f.dialogRef=f.dialog.open(dt)}))),this.SendPassword$=this.actions.pipe(m.ofType(t.AUTH_ACTIONS_TYPE.SEND_PASSWORD),o.tap((function(){f.dialogRef.close()})),o.switchMap((function(t){return f.authService.sendPassword(t.payload).pipe(o.map((function(){return new ut})),o.catchError((function(t){return S.of(new ct(t))})))}))),this.SendPasswordSuccess$=this.actions.pipe(m.ofType(t.AUTH_ACTIONS_TYPE.SEND_PASSWORD_SUCCESS),o.tap((function(){return f.toastService.success(u(f.traductions||{},"messages.passwordResetSuccess","An email for resetting your password has been sent to your address."))}))),this.SendPasswordFailure$=this.actions.pipe(m.ofType(t.AUTH_ACTIONS_TYPE.SEND_PASSWORD_FAILURE),o.tap((function(){return f.toastService.error(u(f.traductions||{},"messages.passwordResetFailure","An error occured. Please try again."))})))}return r.ctorParameters=function(){return[{type:Array,decorators:[{type:e.Inject,args:[O]}]},{type:void 0,decorators:[{type:e.Inject,args:[C]}]},{type:void 0,decorators:[{type:e.Inject,args:[e.PLATFORM_ID]}]},{type:m.Actions},{type:N},{type:s.Router},{type:g.ToastrService},{type:c.MatDialog},{type:i.Store}]},_([m.Effect({dispatch:!1})],r.prototype,"OpenSignUpDialog$",void 0),_([m.Effect()],r.prototype,"SignUp$",void 0),_([m.Effect({dispatch:!1})],r.prototype,"SignUpSuccess$",void 0),_([m.Effect({dispatch:!1})],r.prototype,"SignUpFailure$",void 0),_([m.Effect()],r.prototype,"LogIn$",void 0),_([m.Effect({dispatch:!1})],r.prototype,"LogInSuccess$",void 0),_([m.Effect({dispatch:!1})],r.prototype,"LogInFailure$",void 0),_([m.Effect()],r.prototype,"LogOut$",void 0),_([m.Effect()],r.prototype,"LoadUserInformation$",void 0),_([m.Effect()],r.prototype,"ChangePassword$",void 0),_([m.Effect({dispatch:!1})],r.prototype,"ChangePasswordSuccess$",void 0),_([m.Effect({dispatch:!1})],r.prototype,"ChangePasswordFailure$",void 0),_([m.Effect({dispatch:!1})],r.prototype,"OpenForgottenPasswordDialog$",void 0),_([m.Effect()],r.prototype,"SendPassword$",void 0),_([m.Effect({dispatch:!1})],r.prototype,"SendPasswordSuccess$",void 0),_([m.Effect({dispatch:!1})],r.prototype,"SendPasswordFailure$",void 0),r=_([e.Injectable(),A(0,e.Inject(O)),A(1,e.Inject(C)),A(2,e.Inject(e.PLATFORM_ID))],r)}(),St=function(){function t(){}var o;return o=t,t.forRoot=function(t){return{ngModule:o,providers:[{provide:y,useValue:t.urls},{provide:U,useValue:t.images},{provide:C,useValue:t.traductions},{provide:O,useValue:t.resetActions},{provide:E,useValue:t.styles},{provide:r.HTTP_INTERCEPTORS,useClass:W,multi:!0}]}},t=o=_([e.NgModule({declarations:[pt,dt,ht],imports:[n.CommonModule,r.HttpClientModule,s.RouterModule,a.ReactiveFormsModule,i.StoreModule.forFeature("auth",mt),m.EffectsModule.forFeature([gt]),f.BrowserAnimationsModule,p.MatCardModule,c.MatDialogModule,d.MatButtonModule,l.MatInputModule,h.MatProgressSpinnerModule,g.ToastrModule.forRoot({timeOut:3e3,positionClass:"toast-bottom-right",preventDuplicates:!0})],entryComponents:[dt],exports:[pt,dt],providers:[$]})],t)}();t.AUTH_API_URLS=y,t.AUTH_IMAGES_URLS=U,t.AUTH_RESET_ACTIONS=O,t.AUTH_STYLES=E,t.AUTH_TRADUCTIONS=C,t.AuthGuard=$,t.AuthModule=St,t.AuthService=N,t.ChangePassword=ot,t.ChangePasswordFailure=st,t.ChangePasswordSuccess=nt,t.ForgottenPasswordComponent=dt,t.LoadUserInformation=tt,t.LoadUserInformationFailure=rt,t.LoadUserInformationSuccess=et,t.LogIn=K,t.LogInComponent=pt,t.LogInFailure=X,t.LogInSuccess=Q,t.LogOut=Z,t.OpenForgottenPasswordDialog=it,t.OpenSignUpDialog=q,t.SendPassword=at,t.SendPasswordFailure=ct,t.SendPasswordSuccess=ut,t.SignUp=V,t.SignUpComponent=ht,t.SignUpFailure=J,t.SignUpSuccess=z,t.TokenInterceptor=W,t.UpdateUser=lt,t.authReducer=mt,t.initialState=ft,t.selectAuthState=w,t.selectIsAuthenticated=L,t.selectIsLoginLoading=M,t.selectIsPasswordBeingChanged=j,t.selectIsSignUpLoading=Y,t.selectLogInError=R,t.selectUser=F,t.selectUsersList=k,t.ɵ0=v,t.ɵ1=b,t.ɵ2=D,t.ɵ3=H,t.ɵ4=x,t.ɵ5=G,t.ɵ6=B,t.ɵa=gt,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=angular-auth-lib.umd.min.js.map