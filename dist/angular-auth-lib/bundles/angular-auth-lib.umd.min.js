!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/common/http"),require("rxjs/operators"),require("@angular/common"),require("@angular/router"),require("@ngrx/store"),require("@angular/forms"),require("@angular/material/dialog"),require("@angular/material/input"),require("@angular/material/card"),require("@angular/material/button"),require("@angular/material/progress-spinner"),require("@angular/platform-browser/animations"),require("@ngrx/effects"),require("ngx-toastr"),require("rxjs")):"function"==typeof define&&define.amd?define("angular-auth-lib",["exports","@angular/core","@angular/common/http","rxjs/operators","@angular/common","@angular/router","@ngrx/store","@angular/forms","@angular/material/dialog","@angular/material/input","@angular/material/card","@angular/material/button","@angular/material/progress-spinner","@angular/platform-browser/animations","@ngrx/effects","ngx-toastr","rxjs"],e):e((t=t||self)["angular-auth-lib"]={},t.ng.core,t.ng.common.http,t.rxjs.operators,t.ng.common,t.ng.router,t["@ngrx/store"],t.ng.forms,t.ng.material.dialog,t.ng.material.input,t.ng.material.card,t.ng.material.button,t.ng.material.progressSpinner,t.ng.platformBrowser.animations,t["@ngrx/effects"],t["ngx-toastr"],t.rxjs)}(this,(function(t,e,o,n,r,i,s,a,c,u,l,d,p,h,f,m,g){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var S=function(){return(S=Object.assign||function(t){for(var e,o=1,n=arguments.length;o<n;o++)for(var r in e=arguments[o])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};function A(t,e,o,n){var r,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,o,s):r(e,o))||s);return i>3&&s&&Object.defineProperty(e,o,s),s}function T(t,e){return function(o,n){e(o,n,t)}}function _(t){var e="function"==typeof Symbol&&Symbol.iterator,o=e&&t[e],n=0;if(o)return o.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function I(t,e){var o="function"==typeof Symbol&&t[Symbol.iterator];if(!o)return t;var n,r,i=o.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(t){r={error:t}}finally{try{n&&!n.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return s}var C,y=new e.InjectionToken("Auth api related urls"),U=new e.InjectionToken("Images urls"),P=new e.InjectionToken("Traductions"),E=new e.InjectionToken("Reset actions"),v=new e.InjectionToken("Styling"),O=function(){function t(t,e,o){this.apiUrls=t,this.platformId=e,this.http=o}return t.prototype.decodeToken=function(t){var e=t.split(/\./),o=JSON.parse(window.atob(e[1]));return{token:t,expiringDate:new Date(1e3*o.exp)}},t.prototype.getToken=function(){var t=r.isPlatformBrowser(this.platformId)?sessionStorage.getItem("token"):null;return t?this.decodeToken(t):null},t.prototype.getAccessToken=function(t){var e=this,o={username:t.username,password:t.password};return this.http.post(this.apiUrls.accessTokenUrl,o).pipe(n.map((function(t){return e.decodeToken(t.access)})))},t.prototype.getRefreshToken=function(t){var e=this,o={refresh:t.token};return this.http.post(this.apiUrls.refreshTokenUrl,o).pipe(n.map((function(t){return e.decodeToken(t.access)})))},t.prototype.login=function(t){return this.getAccessToken(t).pipe(n.map((function(e){return S(S({},t),{token:e})})))},t.prototype.getUserInformation=function(){return this.http.get(this.apiUrls.userInformationUrl).pipe(n.map((function(t){return{usersList:t.usersList,user:S(S({},t.user),{dateJoined:new Date(t.user.dateJoined)})}})))},t.prototype.changePassword=function(t){return this.http.put(this.apiUrls.changePasswordUrl,t)},t.prototype.sendPassword=function(t){return this.http.post(this.apiUrls.sendBackPasswordUrl,{email:t})},t.prototype.sendActivationCode=function(t){var e=(new o.HttpParams).append("activationCode",t);return this.http.get(this.apiUrls.sendActivationCodeUrl,{params:e})},t.prototype.createUser=function(t){return this.http.post(this.apiUrls.signUpUrl,t)},t.ctorParameters=function(){return[{type:void 0,decorators:[{type:e.Inject,args:[y]}]},{type:void 0,decorators:[{type:e.Inject,args:[e.PLATFORM_ID]}]},{type:o.HttpClient}]},t.ɵprov=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject(y),e.ɵɵinject(e.PLATFORM_ID),e.ɵɵinject(o.HttpClient))},token:t,providedIn:"root"}),t=A([e.Injectable({providedIn:"root"}),T(0,e.Inject(y)),T(1,e.Inject(e.PLATFORM_ID))],t)}(),N=s.createFeatureSelector("auth"),w=function(t){return t.isAuthenticated},b=s.createSelector(N,w),L=function(t){return t.error},R=s.createSelector(N,L),D=function(t){return t.user},F=s.createSelector(N,D),H=function(t){return t.isPasswordBeingChanged},x=s.createSelector(N,H),j=function(t){return t.usersList},Y=s.createSelector(N,j),k=function(t){return t.isSignUpLoading},B=s.createSelector(N,k),G=function(t){return t.isSendActivationCodeLoading},M=s.createSelector(N,G),$=function(t){return t.isUserActivated},W=s.createSelector(N,$),V=function(t){return t.isUserCreated},q=s.createSelector(N,V),z=function(t){return t.isLoginLoading},J=s.createSelector(N,z),K=function(){function t(t,e,o){this.store=t,this.router=e,this.platformId=o}return t.prototype.canActivate=function(t,e){var o=this;return this.store.pipe(s.select(F),n.withLatestFrom(this.store.pipe(s.select(b))),n.map((function(n){var i=I(n,2),s=i[0],a=i[1];return!!(s&&s.allowedUrls.includes(t.routeConfig.path)&&a)||(s&&s.allowedUrls.includes(t.routeConfig.path)&&r.isPlatformBrowser(o.platformId)&&sessionStorage.setItem("redirectedUrlAfterLogIn",e.url),o.router.navigate(["log-in"]),!1)})))},t.ctorParameters=function(){return[{type:s.Store},{type:i.Router},{type:void 0,decorators:[{type:e.Inject,args:[e.PLATFORM_ID]}]}]},t.ɵprov=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject(s.Store),e.ɵɵinject(i.Router),e.ɵɵinject(e.PLATFORM_ID))},token:t,providedIn:"root"}),t=A([e.Injectable({providedIn:"root"}),T(2,e.Inject(e.PLATFORM_ID))],t)}(),Q=function(){function t(t){this.authService=t}return t.prototype.intercept=function(t,e){var o=this.authService.getToken();return o&&(t=t.clone({setHeaders:{Authorization:"Bearer "+o.token}})),e.handle(t)},t.ctorParameters=function(){return[{type:O}]},t=A([e.Injectable()],t)}();function X(t,e,o){var n,r;void 0===o&&(o=null);var i=e.split("."),s=t;try{for(var a=_(i),c=a.next();!c.done;c=a.next()){if("object"!=typeof(s=s[c.value]||null)&&null!==s)return s;if(null===s)return o||null}}catch(t){n={error:t}}finally{try{c&&!c.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return o||null}(C=t.AUTH_ACTIONS_TYPE||(t.AUTH_ACTIONS_TYPE={})).OPEN_SIGN_UP_DIALOG="[Auth] User wants to sign up",C.SIGN_UP="[Auth] User tries to sign up",C.SIGN_UP_SUCCESS="[Auth] Sign up success",C.SIGN_UP_FAILURE="[Auth] Sign up failure",C.SEND_ACTIVATION_CODE="[Auth] User sends his activation code",C.SEND_ACTIVATION_CODE_SUCCESS="[Auth] Success while sending the activation",C.SEND_ACTIVATION_CODE_FAILURE="[Auth] Activation code failure",C.LOG_IN="[Auth] User tries to log in",C.LOG_IN_SUCCESS="[Auth] Log in success",C.LOG_IN_FAILURE="[Auth] Log in failure",C.LOG_OUT="[Auth] User logs out",C.LOAD_USER_INFORMATION="[Auth] Loading of user information",C.LOAD_USER_INFORMATION_SUCCESS="[Auth] Loading of user information success",C.LOAD_USER_INFORMATION_FAILURE="[Auth] Loading of user information failure",C.CHANGE_PASSWORD="[Auth] User changes his password",C.CHANGE_PASSWORD_SUCCESS="[Auth] Password change success",C.CHANGE_PASSWORD_FAILURE="[Auth] Password change failure",C.OPEN_FORGOTTEN_PASSWORD_DIALOG="[Auth] User opens dialog for password resetting",C.SEND_PASSWORD="[Auth] User has asked for having back a new password",C.SEND_PASSWORD_SUCCESS="[Auth] User has received his password",C.SEND_PASSWORD_FAILURE="[Auth] Error in the process of sending the password to the user",C.UPDATE_USER="[Auth] Update of user",C.RESET_AUTH_STATE="[Auth] Reset Auth state";var Z=function(){this.type=t.AUTH_ACTIONS_TYPE.OPEN_SIGN_UP_DIALOG},tt=function(e){this.payload=e,this.type=t.AUTH_ACTIONS_TYPE.SIGN_UP},et=function(){this.type=t.AUTH_ACTIONS_TYPE.SIGN_UP_SUCCESS},ot=function(e){this.payload=e,this.type=t.AUTH_ACTIONS_TYPE.SIGN_UP_FAILURE},nt=function(e){this.payload=e,this.type=t.AUTH_ACTIONS_TYPE.SEND_ACTIVATION_CODE},rt=function(){this.type=t.AUTH_ACTIONS_TYPE.SEND_ACTIVATION_CODE_SUCCESS},it=function(e){this.payload=e,this.type=t.AUTH_ACTIONS_TYPE.SEND_ACTIVATION_CODE_FAILURE},st=function(e){this.payload=e,this.type=t.AUTH_ACTIONS_TYPE.LOG_IN},at=function(e){this.payload=e,this.type=t.AUTH_ACTIONS_TYPE.LOG_IN_SUCCESS},ct=function(e){this.payload=e,this.type=t.AUTH_ACTIONS_TYPE.LOG_IN_FAILURE},ut=function(){this.type=t.AUTH_ACTIONS_TYPE.LOG_OUT},lt=function(){this.type=t.AUTH_ACTIONS_TYPE.LOAD_USER_INFORMATION},dt=function(e){this.payload=e,this.type=t.AUTH_ACTIONS_TYPE.LOAD_USER_INFORMATION_SUCCESS},pt=function(e){this.payload=e,this.type=t.AUTH_ACTIONS_TYPE.LOAD_USER_INFORMATION_FAILURE},ht=function(e){this.payload=e,this.type=t.AUTH_ACTIONS_TYPE.CHANGE_PASSWORD},ft=function(){this.type=t.AUTH_ACTIONS_TYPE.CHANGE_PASSWORD_SUCCESS},mt=function(e){this.payload=e,this.type=t.AUTH_ACTIONS_TYPE.CHANGE_PASSWORD_FAILURE},gt=function(){this.type=t.AUTH_ACTIONS_TYPE.OPEN_FORGOTTEN_PASSWORD_DIALOG},St=function(e){this.payload=e,this.type=t.AUTH_ACTIONS_TYPE.SEND_PASSWORD},At=function(){this.type=t.AUTH_ACTIONS_TYPE.SEND_PASSWORD_SUCCESS},Tt=function(e){this.payload=e,this.type=t.AUTH_ACTIONS_TYPE.SEND_PASSWORD_FAILURE},_t=function(e){this.payload=e,this.type=t.AUTH_ACTIONS_TYPE.UPDATE_USER},It=function(){this.type=t.AUTH_ACTIONS_TYPE.RESET_AUTH_STATE},Ct=function(){function t(t,e,o,n,r){this.images=t,this.traductions=e,this.styles=o,this.formBuilder=n,this.store=r,this.isPasswordBeingChanged$=this.store.pipe(s.select(x)),this.isLoginLoading$=this.store.pipe(s.select(J)),this.usernamePlaceholder="Username",this.passwordPlaceholder="Password",this.forgottenPassword="Forgot your password?",this.loginButtonTraduction="Log in",this.buttonsBackgroundColor="#3f51b5",this.buttonsColor="white"}return t.prototype.ngOnInit=function(){this.usernamePlaceholder=X(this.traductions||{},"form.usernamePlaceholder",this.usernamePlaceholder),this.passwordPlaceholder=X(this.traductions||{},"form.passwordPlaceholder",this.passwordPlaceholder),this.forgottenPassword=X(this.traductions||{},"buttons.passwordForgotten",this.forgottenPassword),this.loginButtonTraduction=X(this.traductions||{},"buttons.login",this.loginButtonTraduction),this.buttonsBackgroundColor=X(this.styles||{},"buttonsBackgroundColor",this.buttonsBackgroundColor),this.buttonsColor=X(this.styles||{},"buttonsColor",this.buttonsColor),this.userForm=this.formBuilder.group({username:["",a.Validators.required],password:["",a.Validators.required]})},t.prototype.openDialog=function(){this.store.dispatch(new gt)},t.prototype.onSubmit=function(){var t={username:this.userForm.value.username,password:this.userForm.value.password};this.store.dispatch(new st(t))},t.ctorParameters=function(){return[{type:void 0,decorators:[{type:e.Inject,args:[U]}]},{type:void 0,decorators:[{type:e.Inject,args:[P]}]},{type:void 0,decorators:[{type:e.Inject,args:[v]}]},{type:a.FormBuilder},{type:s.Store}]},t=A([e.Component({selector:"auth-lib-log-in",template:'<div id="container" [ngStyle]="{\'background-image\': \'url(\' + images.loginBackgroundImageUrl + \')\'}">\n  <mat-card class="mat-elevation-z8">\n    <img *ngIf="images.logoImageUrl && images.logoImageUrl.length >= 1" [src]="images.logoImageUrl">\n    <form [formGroup]="userForm" (ngSubmit)="onSubmit()">\n\n      <mat-form-field>\n        <input matInput [placeholder]="usernamePlaceholder" formControlName="username">\n      </mat-form-field>\n\n      <mat-form-field>\n          <input matInput type="password" [placeholder]="passwordPlaceholder" formControlName="password">\n      </mat-form-field>\n\n      <button \n        mat-raised-button\n        type="submit" \n        [disabled]="userForm.invalid"\n        *ngIf="!(isPasswordBeingChanged$ | async) && !(isLoginLoading$ | async)"\n        [ngStyle]="{\n          \'background-color\': buttonsBackgroundColor,\n          \'color\': buttonsColor\n        }"\n      >\n        {{ loginButtonTraduction }}\n      </button>\n      <mat-spinner *ngIf="(isPasswordBeingChanged$ | async) || (isLoginLoading$ | async)" [diameter]="36"></mat-spinner>\n\n      <a (click)="openDialog()">{{ forgottenPassword }}</a>\n    </form>\n  </mat-card>\n</div>\n',styles:["#container{display:flex;flex-direction:column;justify-content:center;align-items:center;height:100%;width:100%;flex:1;background-size:cover}#container mat-card{display:flex;flex-direction:column;justify-content:center;align-items:center;height:400px;width:400px;box-sizing:border-box;padding:2%}#container mat-card img{display:block;max-width:200px;max-height:100px;width:auto;height:auto;margin-bottom:20px}#container mat-card form{display:flex;flex:1;flex-direction:column;justify-content:center;align-items:center;width:100%}#container mat-card form mat-form-field{width:75%;font-size:16px}#container mat-card form a,#container mat-card form button,#container mat-card form mat-spinner{margin-top:20px}#container mat-card form a{cursor:pointer;color:#1e90ff;font-size:16px}"]}),T(0,e.Inject(U)),T(1,e.Inject(P)),T(2,e.Inject(v))],t)}(),yt=function(){function t(t,e,o){this.store=t,this.traductions=e,this.styles=o,this.emailPlaceholder="Your email",this.sendButtonTraduction="Send",this.buttonsBackgroundColor="#3f51b5",this.buttonsColor="white"}return t.prototype.ngOnInit=function(){this.emailPlaceholder=X(this.traductions||{},"form.emailPlaceholder",this.emailPlaceholder),this.sendButtonTraduction=X(this.traductions||{},"buttons.send",this.sendButtonTraduction),this.buttonsBackgroundColor=X(this.styles||{},"buttonsBackgroundColor",this.buttonsBackgroundColor),this.buttonsColor=X(this.styles||{},"buttonsColor",this.buttonsColor)},t.prototype.send=function(){this.store.dispatch(new St(this.emailInput.nativeElement.value))},t.ctorParameters=function(){return[{type:s.Store},{type:void 0,decorators:[{type:e.Inject,args:[P]}]},{type:void 0,decorators:[{type:e.Inject,args:[v]}]}]},A([e.ViewChild("email")],t.prototype,"emailInput",void 0),t=A([e.Component({selector:"auth-lib-forgotten-password",template:'<mat-form-field>\n  <input matInput [placeholder]="emailPlaceholder" #email>\n</mat-form-field>\n\n<button \n  mat-raised-button\n  type="button" \n  (click)="send()" \n  [disabled]="!(this.emailInput && this.emailInput.nativeElement && this.emailInput.nativeElement.value)"\n  [ngStyle]="{\n    \'background-color\': buttonsBackgroundColor,\n    \'color\': buttonsColor\n  }"\n>\n  {{ sendButtonTraduction }}\n</button>\n',styles:["mat-form-field{font-size:12px;margin-right:30px;width:230px}"]}),T(1,e.Inject(P)),T(2,e.Inject(v))],t)}(),Ut=function(){function t(t,e,o,n,r){this.traductions=t,this.styles=e,this.dialogRef=o,this.formBuilder=n,this.store=r,this.isSignUpLoading$=this.store.pipe(s.select(B)),this.usernamePlaceholder="Username",this.passwordPlaceholder="Password",this.firstNamePlaceholder="First name",this.lastNamePlaceholder="Last name",this.emailPlaceholder="Email",this.enterprisePlaceholder="Enterprise",this.signUpDialogTitle="Sign Up",this.signupButtonTraduction="Log in",this.buttonsBackgroundColor="#3f51b5",this.buttonsColor="white"}return t.prototype.ngOnInit=function(){this.usernamePlaceholder=X(this.traductions||{},"form.usernamePlaceholder",this.usernamePlaceholder),this.passwordPlaceholder=X(this.traductions||{},"form.passwordPlaceholder",this.passwordPlaceholder),this.firstNamePlaceholder=X(this.traductions||{},"form.firstNamePlaceholder",this.firstNamePlaceholder),this.lastNamePlaceholder=X(this.traductions||{},"form.lastNamePlaceholder",this.lastNamePlaceholder),this.emailPlaceholder=X(this.traductions||{},"form.emailPlaceholder",this.emailPlaceholder),this.enterprisePlaceholder=X(this.traductions||{},"form.enterprisePlaceholder",this.enterprisePlaceholder),this.signUpDialogTitle=X(this.traductions||{},"dialogs.signup",this.signUpDialogTitle),this.signupButtonTraduction=X(this.traductions||{},"buttons.signup",this.signupButtonTraduction),this.buttonsBackgroundColor=X(this.styles||{},"buttonsBackgroundColor",this.buttonsBackgroundColor),this.buttonsColor=X(this.styles||{},"buttonsColor",this.buttonsColor),this.userForm=this.formBuilder.group({username:["",a.Validators.required],password:["",a.Validators.required],firstName:["",a.Validators.required],lastName:["",a.Validators.required],email:["",a.Validators.required],enterprise:""})},t.prototype.onSubmitUser=function(){var t={username:this.userForm.value.username,password:this.userForm.value.password,firstName:this.userForm.value.firstName,lastName:this.userForm.value.lastName,email:this.userForm.value.email,enterprise:this.userForm.value.enterprise||null,isActivated:!1};this.store.dispatch(new tt(t))},t.ctorParameters=function(){return[{type:void 0,decorators:[{type:e.Inject,args:[P]}]},{type:void 0,decorators:[{type:e.Inject,args:[v]}]},{type:c.MatDialogRef},{type:a.FormBuilder},{type:s.Store}]},t=A([e.Component({selector:"auth-lib-sign-up",template:'<div id="container">\n    <h2 mat-dialog-title>{{ signUpDialogTitle }}</h2>\n    <form [formGroup]="userForm" (ngSubmit)="onSubmitUser()">\n\n        <div id="columns">\n            <div id="left-column">\n                <mat-form-field>\n                    <input matInput [placeholder]="usernamePlaceholder" formControlName="username" autocomplete="off">\n                </mat-form-field>\n                <mat-form-field>\n                    <input matInput [placeholder]="firstNamePlaceholder" formControlName="firstName" autocomplete="off">\n                </mat-form-field>\n                <mat-form-field>\n                    <input matInput [placeholder]="emailPlaceholder" formControlName="email" autocomplete="off">\n                </mat-form-field>\n            </div>\n\n            <div id="right-column">\n                <mat-form-field>\n                    <input matInput type="password" [placeholder]="passwordPlaceholder" formControlName="password" autocomplete="off">\n                </mat-form-field>\n                <mat-form-field>\n                    <input matInput [placeholder]="lastNamePlaceholder" formControlName="lastName" autocomplete="off">\n                </mat-form-field>\n                <mat-form-field>\n                    <input matInput [placeholder]="enterprisePlaceholder" formControlName="enterprise" autocomplete="off">\n                </mat-form-field>\n            </div>\n        </div>\n\n        <button\n            *ngIf="!(isSignUpLoading$ | async)"\n            mat-raised-button\n            type="submit"\n            [disabled]="userForm.invalid"\n            [ngStyle]="{\n                \'background-color\': buttonsBackgroundColor,\n                \'color\': buttonsColor\n            }"\n        >\n            {{ signupButtonTraduction }}\n        </button>\n        <mat-spinner *ngIf="isSignUpLoading$ | async" [diameter]="36"></mat-spinner>\n    </form>\n</div>\n',styles:["#container{display:flex;flex-direction:column;width:600px}#container form{margin-top:20px;display:flex;flex-direction:column;justify-content:space-between}#container form #columns{display:flex;flex-direction:row;justify-content:space-between}#container form #columns #left-column{margin-right:20px}#container form #columns #left-column,#container form #columns #right-column{display:flex;flex-direction:column;justify-content:space-between;width:100%}#container mat-form-field{width:100%}#container button{margin-top:20px;-ms-grid-row-align:center;align-self:center}"]}),T(0,e.Inject(P)),T(1,e.Inject(v))],t)}(),Pt=function(){function t(t,e,o,n,r){this.store=t,this.route=e,this.traductions=o,this.styles=n,this.images=r,this.isSendActivationCodeLoading$=this.store.pipe(s.select(M)),this.activationCodePlaceholder="Enter your activation code",this.buttonsBackgroundColor="#3f51b5",this.buttonsColor="white",this.sendActivationButtonTraduction="Send"}return t.prototype.ngOnInit=function(){this.sendActivationButtonTraduction=X(this.traductions||{},"buttons.sendActivationCode",this.sendActivationButtonTraduction),this.activationCodePlaceholder=X(this.traductions||{},"form.activationCodePlaceholder",this.activationCodePlaceholder),this.buttonsBackgroundColor=X(this.styles||{},"buttonsBackgroundColor",this.buttonsBackgroundColor),this.buttonsColor=X(this.styles||{},"buttonsColor",this.buttonsColor)},t.prototype.ngAfterViewInit=function(){var t=this,e=this.route.snapshot.paramMap.get("activationCode");e&&setTimeout((function(){t.activationCodeInput.nativeElement.value=e,t.onSubmitActivationCode()}))},t.prototype.onSubmitActivationCode=function(){var t=this.activationCodeInput.nativeElement.value;t&&this.store.dispatch(new nt(t))},t.ctorParameters=function(){return[{type:s.Store},{type:i.ActivatedRoute},{type:void 0,decorators:[{type:e.Inject,args:[P]}]},{type:void 0,decorators:[{type:e.Inject,args:[v]}]},{type:void 0,decorators:[{type:e.Inject,args:[U]}]}]},A([e.ViewChild("activationCode")],t.prototype,"activationCodeInput",void 0),t=A([e.Component({selector:"auth-lib-activate-user",template:'<div class="activate-password-container" [ngStyle]="{\'background-image\': \'url(\' + images.loginBackgroundImageUrl + \')\'}">\n  <mat-card class="mat-elevation-z8">\n    <img *ngIf="images.logoImageUrl && images.logoImageUrl.length >= 1" [src]="images.logoImageUrl">\n      <mat-form-field>\n        <input matInput [placeholder]="activationCodePlaceholder" #activationCode>\n      </mat-form-field>\n    \n      <button\n          *ngIf="!(isSendActivationCodeLoading$ | async)"\n          mat-raised-button\n          type="button"\n          [disabled]="!(this.activationCodeInput && this.activationCodeInput.nativeElement && this.activationCodeInput.nativeElement.value)"\n          (click)="onSubmitActivationCode()"\n          [ngStyle]="{\n            \'background-color\': buttonsBackgroundColor,\n            \'color\': buttonsColor\n          }"\n      >\n          {{ sendActivationButtonTraduction }}\n      </button>\n      <mat-spinner *ngIf="isSendActivationCodeLoading$ | async" [diameter]="36"></mat-spinner>\n  </mat-card>\n</div>\n',styles:[".activate-password-container{display:flex;flex-direction:column;justify-content:center;align-items:center;height:100%;width:100%;flex:1;background-size:cover}.activate-password-container mat-card{display:flex;flex-direction:column;justify-content:center;align-items:center;height:400px;width:400px;box-sizing:border-box;padding:2%}.activate-password-container mat-card img{display:block;max-width:200px;max-height:100px;width:auto;height:auto;margin-bottom:20px}.activate-password-container mat-card mat-form-field{width:75%;font-size:16px}.activate-password-container mat-card button,.activate-password-container mat-card mat-spinner{margin-top:20px}"]}),T(2,e.Inject(P)),T(3,e.Inject(v)),T(4,e.Inject(U))],t)}(),Et={isAuthenticated:!1,isSignUpLoading:!1,isSendActivationCodeLoading:!1,isUserActivated:null,isUserCreated:null,isLoginLoading:!1,user:null,error:null,isPasswordBeingChanged:!1,usersList:null};function vt(e,o){switch(void 0===e&&(e=Et),o.type){case t.AUTH_ACTIONS_TYPE.SIGN_UP:return S(S({},e),{error:null,isSignUpLoading:!0});case t.AUTH_ACTIONS_TYPE.SIGN_UP_FAILURE:return S(S({},e),{error:o.payload,isSignUpLoading:!1,isUserCreated:!1});case t.AUTH_ACTIONS_TYPE.SIGN_UP_SUCCESS:return S(S({},e),{error:null,isSignUpLoading:!1,isUserCreated:!0});case t.AUTH_ACTIONS_TYPE.SEND_ACTIVATION_CODE:return S(S({},e),{error:null,isSendActivationCodeLoading:!0});case t.AUTH_ACTIONS_TYPE.SEND_ACTIVATION_CODE_FAILURE:return S(S({},e),{error:o.payload,isSendActivationCodeLoading:!1,isUserActivated:!1});case t.AUTH_ACTIONS_TYPE.SEND_ACTIVATION_CODE_SUCCESS:return S(S({},e),{error:null,isSendActivationCodeLoading:!1,isUserActivated:!0});case t.AUTH_ACTIONS_TYPE.LOG_IN:return S(S({},e),{error:null,isLoginLoading:!0});case t.AUTH_ACTIONS_TYPE.LOG_IN_SUCCESS:return S(S({},e),{isAuthenticated:!0,user:o.payload.user,error:null,usersList:o.payload.usersList,isLoginLoading:!1});case t.AUTH_ACTIONS_TYPE.LOG_IN_FAILURE:return S(S({},e),{error:o.payload,isLoginLoading:!1});case t.AUTH_ACTIONS_TYPE.LOG_OUT:return Et;case t.AUTH_ACTIONS_TYPE.LOAD_USER_INFORMATION_SUCCESS:var n=S(S({},e.user),o.payload);return S(S({},e),{user:n});case t.AUTH_ACTIONS_TYPE.CHANGE_PASSWORD:case t.AUTH_ACTIONS_TYPE.SEND_PASSWORD:return S(S({},e),{isPasswordBeingChanged:!0});case t.AUTH_ACTIONS_TYPE.CHANGE_PASSWORD_SUCCESS:case t.AUTH_ACTIONS_TYPE.CHANGE_PASSWORD_FAILURE:case t.AUTH_ACTIONS_TYPE.SEND_PASSWORD_SUCCESS:case t.AUTH_ACTIONS_TYPE.SEND_PASSWORD_FAILURE:return S(S({},e),{isPasswordBeingChanged:!1});case t.AUTH_ACTIONS_TYPE.UPDATE_USER:return S(S({},e),{user:S(S({},e.user),o.payload)});case t.AUTH_ACTIONS_TYPE.RESET_AUTH_STATE:return Et;default:return e}}var Ot=function(){function o(e,o,i,a,c,u,l,d,p){var h=this;this.resetActions=e,this.traductions=o,this.platformId=i,this.actions=a,this.authService=c,this.router=u,this.toastService=l,this.dialog=d,this.store=p,this.OpenSignUpDialog$=this.actions.pipe(f.ofType(t.AUTH_ACTIONS_TYPE.OPEN_SIGN_UP_DIALOG),n.tap((function(){return h.dialogRef=h.dialog.open(Ut)}))),this.SignUp$=this.actions.pipe(f.ofType(t.AUTH_ACTIONS_TYPE.SIGN_UP),n.map((function(t){return t.payload})),n.switchMap((function(t){return h.authService.createUser(t).pipe(n.map((function(){return new et})),n.catchError((function(t){return g.of(new ot(t))})))}))),this.SignUpSuccess$=this.actions.pipe(f.ofType(t.AUTH_ACTIONS_TYPE.SIGN_UP_SUCCESS),n.tap((function(){h.toastService.success(X(h.traductions||{},"messages.signupSuccess","Your account has been created!")),h.dialogRef&&h.dialogRef.close()}))),this.SignUpFailure$=this.actions.pipe(f.ofType(t.AUTH_ACTIONS_TYPE.SIGN_UP_FAILURE),n.map((function(t){return t.payload})),n.tap((function(t){return h.toastService.error(X(h.traductions||{},"messages.signupFailure","Please try again."))}))),this.SendActivationCode$=this.actions.pipe(f.ofType(t.AUTH_ACTIONS_TYPE.SEND_ACTIVATION_CODE),n.map((function(t){return t.payload})),n.switchMap((function(t){return h.authService.sendActivationCode(t).pipe(n.map((function(){return new rt})),n.catchError((function(t){return g.of(new it(t))})))}))),this.SendActivationCodeSuccess$=this.actions.pipe(f.ofType(t.AUTH_ACTIONS_TYPE.SEND_ACTIVATION_CODE_SUCCESS),n.tap((function(){h.toastService.success(X(h.traductions||{},"messages.sendActivationCodeSuccess","Your account has been verified!")),h.router.navigate(["log-in"])})),n.map((function(){return new It}))),this.SendActivationCodeFailure$=this.actions.pipe(f.ofType(t.AUTH_ACTIONS_TYPE.SEND_ACTIVATION_CODE_FAILURE),n.tap((function(t){return h.toastService.error(X(h.traductions||{},"messages.sendActivationCodeFailure","Please try again with the correct code."))}))),this.LogIn$=this.actions.pipe(f.ofType(t.AUTH_ACTIONS_TYPE.LOG_IN),n.filter((function(t){return r.isPlatformBrowser(h.platformId)})),n.map((function(t){return t.payload})),n.switchMap((function(t){return h.authService.login(t).pipe(n.concatMap((function(t){return sessionStorage.setItem("token",t.token.token),h.authService.getUserInformation().pipe(n.map((function(t){var e=t.user,o=t.usersList;return new at({user:e,usersList:o})})),n.catchError((function(t){return g.of(new ct(t))})))})),n.catchError((function(t){return g.of(new ct(t))})))}))),this.LogInSuccess$=this.actions.pipe(f.ofType(t.AUTH_ACTIONS_TYPE.LOG_IN_SUCCESS),n.filter((function(t){return r.isPlatformBrowser(h.platformId)})),n.withLatestFrom(this.store.pipe(s.select(F))),n.tap((function(t){var e=I(t,2),o=(e[0],e[1]),n=sessionStorage.getItem("redirectedUrlAfterLogIn");n&&r.isPlatformBrowser(h.platformId)?(h.router.navigateByUrl(n),sessionStorage.removeItem("redirectedUrlAfterLogIn")):h.router.navigateByUrl(o.redirectUrlAfterLogin),h.toastService.success(X(h.traductions||{},"messages.loginSuccess","Hi! Nice to see you again!"))}))),this.LogInFailure$=this.actions.pipe(f.ofType(t.AUTH_ACTIONS_TYPE.LOG_IN_FAILURE),n.tap((function(t){return h.toastService.error(X(h.traductions||{},"messages.loginFailure","Wrong credentials. Please check again."))}))),this.LogOut$=this.actions.pipe(f.ofType(t.AUTH_ACTIONS_TYPE.LOG_OUT),n.filter((function(t){return r.isPlatformBrowser(h.platformId)})),n.switchMap((function(t){return sessionStorage.removeItem("token"),h.router.navigate(["log-in"]),(h.resetActions||[]).map((function(t){return new t}))}))),this.LoadUserInformation$=this.actions.pipe(f.ofType(t.AUTH_ACTIONS_TYPE.LOAD_USER_INFORMATION),n.switchMap((function(t){return h.authService.getUserInformation().pipe(n.map((function(t){var e=t.user;t.usersList;return new dt(e)})),n.catchError((function(t){return g.of(new pt(t))})))}))),this.ChangePassword$=this.actions.pipe(f.ofType(t.AUTH_ACTIONS_TYPE.CHANGE_PASSWORD),n.switchMap((function(t){return h.authService.changePassword(t.payload).pipe(n.map((function(){return new ft})),n.catchError((function(t){return g.of(new mt(t))})))}))),this.ChangePasswordSuccess$=this.actions.pipe(f.ofType(t.AUTH_ACTIONS_TYPE.CHANGE_PASSWORD_SUCCESS),n.tap((function(){return h.toastService.success(X(h.traductions||{},"messages.changePasswordSuccess","Your password has been successfully changed!"))}))),this.ChangePasswordFailure$=this.actions.pipe(f.ofType(t.AUTH_ACTIONS_TYPE.CHANGE_PASSWORD_FAILURE),n.tap((function(t){return h.toastService.error(X(h.traductions||{},"messages.changePasswordFailure","Wrong current password. Please try again."))}))),this.OpenForgottenPasswordDialog$=this.actions.pipe(f.ofType(t.AUTH_ACTIONS_TYPE.OPEN_FORGOTTEN_PASSWORD_DIALOG),n.tap((function(){return h.dialogRef=h.dialog.open(yt)}))),this.SendPassword$=this.actions.pipe(f.ofType(t.AUTH_ACTIONS_TYPE.SEND_PASSWORD),n.tap((function(){h.dialogRef.close()})),n.switchMap((function(t){return h.authService.sendPassword(t.payload).pipe(n.map((function(){return new At})),n.catchError((function(t){return g.of(new Tt(t))})))}))),this.SendPasswordSuccess$=this.actions.pipe(f.ofType(t.AUTH_ACTIONS_TYPE.SEND_PASSWORD_SUCCESS),n.tap((function(){return h.toastService.success(X(h.traductions||{},"messages.passwordResetSuccess","An email for resetting your password has been sent to your address."))}))),this.SendPasswordFailure$=this.actions.pipe(f.ofType(t.AUTH_ACTIONS_TYPE.SEND_PASSWORD_FAILURE),n.tap((function(){return h.toastService.error(X(h.traductions||{},"messages.passwordResetFailure","An error occured. Please try again."))})))}return o.ctorParameters=function(){return[{type:Array,decorators:[{type:e.Inject,args:[E]}]},{type:void 0,decorators:[{type:e.Inject,args:[P]}]},{type:void 0,decorators:[{type:e.Inject,args:[e.PLATFORM_ID]}]},{type:f.Actions},{type:O},{type:i.Router},{type:m.ToastrService},{type:c.MatDialog},{type:s.Store}]},A([f.Effect({dispatch:!1})],o.prototype,"OpenSignUpDialog$",void 0),A([f.Effect()],o.prototype,"SignUp$",void 0),A([f.Effect({dispatch:!1})],o.prototype,"SignUpSuccess$",void 0),A([f.Effect({dispatch:!1})],o.prototype,"SignUpFailure$",void 0),A([f.Effect()],o.prototype,"SendActivationCode$",void 0),A([f.Effect()],o.prototype,"SendActivationCodeSuccess$",void 0),A([f.Effect({dispatch:!1})],o.prototype,"SendActivationCodeFailure$",void 0),A([f.Effect()],o.prototype,"LogIn$",void 0),A([f.Effect({dispatch:!1})],o.prototype,"LogInSuccess$",void 0),A([f.Effect({dispatch:!1})],o.prototype,"LogInFailure$",void 0),A([f.Effect()],o.prototype,"LogOut$",void 0),A([f.Effect()],o.prototype,"LoadUserInformation$",void 0),A([f.Effect()],o.prototype,"ChangePassword$",void 0),A([f.Effect({dispatch:!1})],o.prototype,"ChangePasswordSuccess$",void 0),A([f.Effect({dispatch:!1})],o.prototype,"ChangePasswordFailure$",void 0),A([f.Effect({dispatch:!1})],o.prototype,"OpenForgottenPasswordDialog$",void 0),A([f.Effect()],o.prototype,"SendPassword$",void 0),A([f.Effect({dispatch:!1})],o.prototype,"SendPasswordSuccess$",void 0),A([f.Effect({dispatch:!1})],o.prototype,"SendPasswordFailure$",void 0),o=A([e.Injectable(),T(0,e.Inject(E)),T(1,e.Inject(P)),T(2,e.Inject(e.PLATFORM_ID))],o)}(),Nt=function(){function t(){}var n;return n=t,t.forRoot=function(t){return{ngModule:n,providers:[{provide:y,useValue:t.urls},{provide:U,useValue:t.images},{provide:P,useValue:t.traductions},{provide:E,useValue:t.resetActions},{provide:v,useValue:t.styles},{provide:o.HTTP_INTERCEPTORS,useClass:Q,multi:!0}]}},t=n=A([e.NgModule({declarations:[Ct,yt,Ut,Pt],imports:[r.CommonModule,o.HttpClientModule,i.RouterModule,a.ReactiveFormsModule,s.StoreModule.forFeature("auth",vt),f.EffectsModule.forFeature([Ot]),h.BrowserAnimationsModule,l.MatCardModule,c.MatDialogModule,d.MatButtonModule,u.MatInputModule,p.MatProgressSpinnerModule,m.ToastrModule.forRoot({timeOut:3e3,positionClass:"toast-bottom-right",preventDuplicates:!0})],entryComponents:[yt],exports:[Ct,yt,Ut,Pt],providers:[K]})],t)}();t.AUTH_API_URLS=y,t.AUTH_IMAGES_URLS=U,t.AUTH_RESET_ACTIONS=E,t.AUTH_STYLES=v,t.AUTH_TRADUCTIONS=P,t.ActivateUserComponent=Pt,t.AuthGuard=K,t.AuthModule=Nt,t.AuthService=O,t.ChangePassword=ht,t.ChangePasswordFailure=mt,t.ChangePasswordSuccess=ft,t.ForgottenPasswordComponent=yt,t.LoadUserInformation=lt,t.LoadUserInformationFailure=pt,t.LoadUserInformationSuccess=dt,t.LogIn=st,t.LogInComponent=Ct,t.LogInFailure=ct,t.LogInSuccess=at,t.LogOut=ut,t.OpenForgottenPasswordDialog=gt,t.OpenSignUpDialog=Z,t.ResetAuthState=It,t.SendActivationCode=nt,t.SendActivationCodeFailure=it,t.SendActivationCodeSuccess=rt,t.SendPassword=St,t.SendPasswordFailure=Tt,t.SendPasswordSuccess=At,t.SignUp=tt,t.SignUpComponent=Ut,t.SignUpFailure=ot,t.SignUpSuccess=et,t.TokenInterceptor=Q,t.UpdateUser=_t,t.authReducer=vt,t.initialState=Et,t.selectAuthState=N,t.selectIsActivated=W,t.selectIsAuthenticated=b,t.selectIsLoginLoading=J,t.selectIsPasswordBeingChanged=x,t.selectIsSendActivationCodeLoading=M,t.selectIsSignUpLoading=B,t.selectIsUserCreated=q,t.selectLogInError=R,t.selectUser=F,t.selectUsersList=Y,t.ɵ0=w,t.ɵ1=L,t.ɵ2=D,t.ɵ3=H,t.ɵ4=j,t.ɵ5=k,t.ɵ6=G,t.ɵ7=$,t.ɵ8=V,t.ɵ9=z,t.ɵa=Ot,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=angular-auth-lib.umd.min.js.map