!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/common/http"),require("rxjs/operators"),require("@angular/common"),require("@angular/router"),require("@ngrx/store"),require("@angular/forms"),require("@angular/material/dialog"),require("@angular/material/input"),require("@angular/material/card"),require("@angular/material/button"),require("@angular/material/progress-spinner"),require("@angular/platform-browser/animations"),require("@ngrx/effects"),require("ngx-toastr"),require("rxjs")):"function"==typeof define&&define.amd?define("angular-auth-lib",["exports","@angular/core","@angular/common/http","rxjs/operators","@angular/common","@angular/router","@ngrx/store","@angular/forms","@angular/material/dialog","@angular/material/input","@angular/material/card","@angular/material/button","@angular/material/progress-spinner","@angular/platform-browser/animations","@ngrx/effects","ngx-toastr","rxjs"],e):e((t=t||self)["angular-auth-lib"]={},t.ng.core,t.ng.common.http,t.rxjs.operators,t.ng.common,t.ng.router,t["@ngrx/store"],t.ng.forms,t.ng.material.dialog,t.ng.material.input,t.ng.material.card,t.ng.material.button,t.ng.material.progressSpinner,t.ng.platformBrowser.animations,t["@ngrx/effects"],t["ngx-toastr"],t.rxjs)}(this,(function(t,e,r,o,n,i,s,a,u,c,l,p,d,h,f,m,g){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var S=function(){return(S=Object.assign||function(t){for(var e,r=1,o=arguments.length;r<o;r++)for(var n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)};function T(t,e,r,o){var n,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,r,o);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(i<3?n(s):i>3?n(e,r,s):n(e,r))||s);return i>3&&s&&Object.defineProperty(e,r,s),s}function _(t,e){return function(r,o){e(r,o,t)}}function A(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function I(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)s.push(o.value)}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return s}var P,y=new e.InjectionToken("Auth api related urls"),U=new e.InjectionToken("Images urls"),C=new e.InjectionToken("Traductions"),O=new e.InjectionToken("Reset actions"),E=new e.InjectionToken("Styling"),N=function(){function t(t,e,r){this.apiUrls=t,this.platformId=e,this.http=r}return t.prototype.decodeToken=function(t){var e=t.split(/\./),r=JSON.parse(window.atob(e[1]));return{token:t,expiringDate:new Date(1e3*r.exp)}},t.prototype.getToken=function(){var t=n.isPlatformBrowser(this.platformId)?sessionStorage.getItem("token"):null;return t?this.decodeToken(t):null},t.prototype.getAccessToken=function(t){var e=this,r={username:t.username,password:t.password};return this.http.post(this.apiUrls.accessTokenUrl,r).pipe(o.map((function(t){return e.decodeToken(t.access)})))},t.prototype.getRefreshToken=function(t){var e=this,r={refresh:t.token};return this.http.post(this.apiUrls.refreshTokenUrl,r).pipe(o.map((function(t){return e.decodeToken(t.access)})))},t.prototype.login=function(t){return this.getAccessToken(t).pipe(o.map((function(e){return S(S({},t),{token:e})})))},t.prototype.getUserInformation=function(){return this.http.get(this.apiUrls.userInformationUrl).pipe(o.map((function(t){return{usersList:t.usersList,user:S(S({},t.user),{dateJoined:new Date(t.user.dateJoined)})}})))},t.prototype.changePassword=function(t){return this.http.put(this.apiUrls.changePasswordUrl,t)},t.prototype.sendPassword=function(t){return this.http.post(this.apiUrls.sendBackPasswordUrl,{email:t})},t.prototype.createUser=function(t){return this.http.post(this.apiUrls.signUpUrl,t)},t.ctorParameters=function(){return[{type:void 0,decorators:[{type:e.Inject,args:[y]}]},{type:void 0,decorators:[{type:e.Inject,args:[e.PLATFORM_ID]}]},{type:r.HttpClient}]},t.ɵprov=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject(y),e.ɵɵinject(e.PLATFORM_ID),e.ɵɵinject(r.HttpClient))},token:t,providedIn:"root"}),t=T([e.Injectable({providedIn:"root"}),_(0,e.Inject(y)),_(1,e.Inject(e.PLATFORM_ID))],t)}(),w=s.createFeatureSelector("auth"),v=function(t){return t.isAuthenticated},L=s.createSelector(w,v),b=function(t){return t.error},R=s.createSelector(w,b),D=function(t){return t.user},F=s.createSelector(w,D),H=function(t){return t.isPasswordBeingChanged},j=s.createSelector(w,H),x=function(t){return t.usersList},k=s.createSelector(w,x),G=function(t){return t.isSignUpLoading},Y=s.createSelector(w,G),B=function(t){return t.isLoginLoading},M=s.createSelector(w,B),$=function(){function t(t,e,r){this.store=t,this.router=e,this.platformId=r}return t.prototype.canActivate=function(t,e){var r=this;return this.store.pipe(s.select(F),o.withLatestFrom(this.store.pipe(s.select(L))),o.map((function(o){var i=I(o,2),s=i[0],a=i[1];return!!(s&&s.allowedUrls.includes(t.routeConfig.path)&&a)||(s&&s.allowedUrls.includes(t.routeConfig.path)&&n.isPlatformBrowser(r.platformId)&&sessionStorage.setItem("redirectedUrlAfterLogIn",e.url),r.router.navigate(["log-in"]),!1)})))},t.ctorParameters=function(){return[{type:s.Store},{type:i.Router},{type:void 0,decorators:[{type:e.Inject,args:[e.PLATFORM_ID]}]}]},t.ɵprov=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject(s.Store),e.ɵɵinject(i.Router),e.ɵɵinject(e.PLATFORM_ID))},token:t,providedIn:"root"}),t=T([e.Injectable({providedIn:"root"}),_(2,e.Inject(e.PLATFORM_ID))],t)}(),W=function(){function t(t){this.authService=t}return t.prototype.intercept=function(t,e){var r=this.authService.getToken();return r&&(t=t.clone({setHeaders:{Authorization:"Bearer "+r.token}})),e.handle(t)},t.ctorParameters=function(){return[{type:N}]},t=T([e.Injectable()],t)}();function q(t,e,r){var o,n;void 0===r&&(r=null);var i=e.split("."),s=t;try{for(var a=A(i),u=a.next();!u.done;u=a.next()){if("object"!=typeof(s=s[u.value]||null)&&null!==s)return s;if(null===s)return r||null}}catch(t){o={error:t}}finally{try{u&&!u.done&&(n=a.return)&&n.call(a)}finally{if(o)throw o.error}}return r||null}(P=t.AUTH_ACTIONS_TYPE||(t.AUTH_ACTIONS_TYPE={})).OPEN_SIGN_UP_DIALOG="[Auth] User wants to sign up",P.SIGN_UP="[Auth] User tries to sign up",P.SIGN_UP_SUCCESS="[Auth] Sign up success",P.SIGN_UP_FAILURE="[Auth] Sign up failure",P.LOG_IN="[Auth] User tries to log in",P.LOG_IN_SUCCESS="[Auth] Log in success",P.LOG_IN_FAILURE="[Auth] Log in failure",P.LOG_OUT="[Auth] User logs out",P.LOAD_USER_INFORMATION="[Auth] Loading of user information",P.LOAD_USER_INFORMATION_SUCCESS="[Auth] Loading of user information success",P.LOAD_USER_INFORMATION_FAILURE="[Auth] Loading of user information failure",P.CHANGE_PASSWORD="[Auth] User changes his password",P.CHANGE_PASSWORD_SUCCESS="[Auth] Password change success",P.CHANGE_PASSWORD_FAILURE="[Auth] Password change failure",P.OPEN_FORGOTTEN_PASSWORD_DIALOG="[Auth] User opens dialog for password resetting",P.SEND_PASSWORD="[Auth] User has asked for having back a new password",P.SEND_PASSWORD_SUCCESS="[Auth] User has received his password",P.SEND_PASSWORD_FAILURE="[Auth] Error in the process of sending the password to the user",P.UPDATE_USER="[Auth] Update of user";var V=function(){this.type=t.AUTH_ACTIONS_TYPE.OPEN_SIGN_UP_DIALOG},z=function(e){this.payload=e,this.type=t.AUTH_ACTIONS_TYPE.SIGN_UP},J=function(){this.type=t.AUTH_ACTIONS_TYPE.SIGN_UP_SUCCESS},K=function(e){this.payload=e,this.type=t.AUTH_ACTIONS_TYPE.SIGN_UP_FAILURE},Q=function(e){this.payload=e,this.type=t.AUTH_ACTIONS_TYPE.LOG_IN},X=function(e){this.payload=e,this.type=t.AUTH_ACTIONS_TYPE.LOG_IN_SUCCESS},Z=function(e){this.payload=e,this.type=t.AUTH_ACTIONS_TYPE.LOG_IN_FAILURE},tt=function(){this.type=t.AUTH_ACTIONS_TYPE.LOG_OUT},et=function(){this.type=t.AUTH_ACTIONS_TYPE.LOAD_USER_INFORMATION},rt=function(e){this.payload=e,this.type=t.AUTH_ACTIONS_TYPE.LOAD_USER_INFORMATION_SUCCESS},ot=function(e){this.payload=e,this.type=t.AUTH_ACTIONS_TYPE.LOAD_USER_INFORMATION_FAILURE},nt=function(e){this.payload=e,this.type=t.AUTH_ACTIONS_TYPE.CHANGE_PASSWORD},it=function(){this.type=t.AUTH_ACTIONS_TYPE.CHANGE_PASSWORD_SUCCESS},st=function(e){this.payload=e,this.type=t.AUTH_ACTIONS_TYPE.CHANGE_PASSWORD_FAILURE},at=function(){this.type=t.AUTH_ACTIONS_TYPE.OPEN_FORGOTTEN_PASSWORD_DIALOG},ut=function(e){this.payload=e,this.type=t.AUTH_ACTIONS_TYPE.SEND_PASSWORD},ct=function(){this.type=t.AUTH_ACTIONS_TYPE.SEND_PASSWORD_SUCCESS},lt=function(e){this.payload=e,this.type=t.AUTH_ACTIONS_TYPE.SEND_PASSWORD_FAILURE},pt=function(e){this.payload=e,this.type=t.AUTH_ACTIONS_TYPE.UPDATE_USER},dt=function(){function t(t,e,r,o,n){this.images=t,this.traductions=e,this.styles=r,this.formBuilder=o,this.store=n,this.isPasswordBeingChanged$=this.store.pipe(s.select(j)),this.isLoginLoading$=this.store.pipe(s.select(M)),this.usernamePlaceholder="Username",this.passwordPlaceholder="Password",this.forgottenPassword="Forgot your password?",this.loginButtonTraduction="Log in",this.buttonsBackgroundColor="#3f51b5",this.buttonsColor="white"}return t.prototype.ngOnInit=function(){this.usernamePlaceholder=q(this.traductions||{},"form.usernamePlaceholder",this.usernamePlaceholder),this.passwordPlaceholder=q(this.traductions||{},"form.passwordPlaceholder",this.passwordPlaceholder),this.forgottenPassword=q(this.traductions||{},"buttons.passwordForgotten",this.forgottenPassword),this.loginButtonTraduction=q(this.traductions||{},"buttons.login",this.loginButtonTraduction),this.buttonsBackgroundColor=q(this.styles||{},"buttonsBackgroundColor",this.buttonsBackgroundColor),this.buttonsColor=q(this.styles||{},"buttonsColor",this.buttonsColor),this.userForm=this.formBuilder.group({username:["",a.Validators.required],password:["",a.Validators.required]})},t.prototype.openDialog=function(){this.store.dispatch(new at)},t.prototype.onSubmit=function(){var t={username:this.userForm.value.username,password:this.userForm.value.password};this.store.dispatch(new Q(t))},t.ctorParameters=function(){return[{type:void 0,decorators:[{type:e.Inject,args:[U]}]},{type:void 0,decorators:[{type:e.Inject,args:[C]}]},{type:void 0,decorators:[{type:e.Inject,args:[E]}]},{type:a.FormBuilder},{type:s.Store}]},t=T([e.Component({selector:"auth-lib-log-in",template:'<div id="container" [ngStyle]="{\'background-image\': \'url(\' + images.loginBackgroundImageUrl + \')\'}">\n  <mat-card class="mat-elevation-z8">\n    <img *ngIf="images.logoImageUrl && images.logoImageUrl.length >= 1" [src]="images.logoImageUrl">\n    <form [formGroup]="userForm" (ngSubmit)="onSubmit()">\n\n      <mat-form-field>\n        <input matInput [placeholder]="usernamePlaceholder" formControlName="username">\n      </mat-form-field>\n\n      <mat-form-field>\n          <input matInput type="password" [placeholder]="passwordPlaceholder" formControlName="password">\n      </mat-form-field>\n\n      <button \n        mat-raised-button\n        type="submit" \n        [disabled]="userForm.invalid"\n        *ngIf="!(isPasswordBeingChanged$ | async) && !(isLoginLoading$ | async)"\n        [ngStyle]="{\n          \'background-color\': buttonsBackgroundColor,\n          \'color\': buttonsColor\n        }"\n      >\n        {{ loginButtonTraduction }}\n      </button>\n      <mat-spinner *ngIf="(isPasswordBeingChanged$ | async) || (isLoginLoading$ | async)" [diameter]="36"></mat-spinner>\n\n      <a (click)="openDialog()">{{ forgottenPassword }}</a>\n    </form>\n  </mat-card>\n</div>\n',styles:["#container{display:flex;flex-direction:column;justify-content:center;align-items:center;height:100%;width:100%;flex:1;background-size:cover}#container mat-card{display:flex;flex-direction:column;justify-content:center;align-items:center;height:400px;width:400px;box-sizing:border-box;padding:2%}#container mat-card img{display:block;max-width:200px;max-height:100px;width:auto;height:auto;margin-bottom:20px}#container mat-card form{display:flex;flex:1;flex-direction:column;justify-content:center;align-items:center;width:100%}#container mat-card form mat-form-field{width:75%;font-size:16px}#container mat-card form a,#container mat-card form button,#container mat-card form mat-spinner{margin-top:20px}#container mat-card form a{cursor:pointer;color:#1e90ff;font-size:16px}"]}),_(0,e.Inject(U)),_(1,e.Inject(C)),_(2,e.Inject(E))],t)}(),ht=function(){function t(t,e,r){this.store=t,this.traductions=e,this.styles=r,this.emailPlaceholder="Your email",this.sendButtonTraduction="Send",this.buttonsBackgroundColor="#3f51b5",this.buttonsColor="white"}return t.prototype.ngOnInit=function(){this.emailPlaceholder=q(this.traductions||{},"form.emailPlaceholder",this.emailPlaceholder),this.sendButtonTraduction=q(this.traductions||{},"buttons.send",this.sendButtonTraduction),this.buttonsBackgroundColor=q(this.styles||{},"buttonsBackgroundColor",this.buttonsBackgroundColor),this.buttonsColor=q(this.styles||{},"buttonsColor",this.buttonsColor)},t.prototype.send=function(){this.store.dispatch(new ut(this.emailInput.nativeElement.value))},t.ctorParameters=function(){return[{type:s.Store},{type:void 0,decorators:[{type:e.Inject,args:[C]}]},{type:void 0,decorators:[{type:e.Inject,args:[E]}]}]},T([e.ViewChild("email")],t.prototype,"emailInput",void 0),t=T([e.Component({selector:"auth-lib-forgotten-password",template:'<mat-form-field>\n  <input matInput [placeholder]="emailPlaceholder" #email>\n</mat-form-field>\n\n<button \n  mat-raised-button\n  type="button" \n  (click)="send()" \n  [disabled]="!(this.emailInput && this.emailInput.nativeElement && this.emailInput.nativeElement.value)"\n  [ngStyle]="{\n    \'background-color\': buttonsBackgroundColor,\n    \'color\': buttonsColor\n  }"\n>\n  {{ sendButtonTraduction }}\n</button>\n',styles:["mat-form-field{font-size:12px;margin-right:30px;width:230px}"]}),_(1,e.Inject(C)),_(2,e.Inject(E))],t)}(),ft=function(){function t(t,e,r,o,n){this.traductions=t,this.styles=e,this.dialogRef=r,this.formBuilder=o,this.store=n,this.usernamePlaceholder="Username",this.passwordPlaceholder="Password",this.firstNamePlaceholder="First name",this.lastNamePlaceholder="Last name",this.emailPlaceholder="Email",this.enterprisePlaceholder="Enterprise",this.signUpDialogTitle="Sign Up",this.signupButtonTraduction="Log in",this.buttonsBackgroundColor="#3f51b5",this.buttonsColor="white"}return t.prototype.ngOnInit=function(){this.usernamePlaceholder=q(this.traductions||{},"form.usernamePlaceholder",this.usernamePlaceholder),this.passwordPlaceholder=q(this.traductions||{},"form.passwordPlaceholder",this.passwordPlaceholder),this.firstNamePlaceholder=q(this.traductions||{},"form.firstNamePlaceholder",this.firstNamePlaceholder),this.lastNamePlaceholder=q(this.traductions||{},"form.lastNamePlaceholder",this.lastNamePlaceholder),this.emailPlaceholder=q(this.traductions||{},"form.emailPlaceholder",this.emailPlaceholder),this.enterprisePlaceholder=q(this.traductions||{},"form.enterprisePlaceholder",this.enterprisePlaceholder),this.signUpDialogTitle=q(this.traductions||{},"dialogs.signup",this.signUpDialogTitle),this.signupButtonTraduction=q(this.traductions||{},"buttons.signup",this.signupButtonTraduction),this.buttonsBackgroundColor=q(this.styles||{},"buttonsBackgroundColor",this.buttonsBackgroundColor),this.buttonsColor=q(this.styles||{},"buttonsColor",this.buttonsColor),this.userForm=this.formBuilder.group({username:["",a.Validators.required],password:["",a.Validators.required],firstName:["",a.Validators.required],lastName:["",a.Validators.required],email:["",a.Validators.required],enterprise:""})},t.prototype.onSubmit=function(){var t={username:this.userForm.value.username,password:this.userForm.value.password,firstName:this.userForm.value.firstName,lastName:this.userForm.value.lastName,email:this.userForm.value.email,enterprise:this.userForm.value.enterprise||null};this.store.dispatch(new z(t)),this.dialogRef.close()},t.ctorParameters=function(){return[{type:void 0,decorators:[{type:e.Inject,args:[C]}]},{type:void 0,decorators:[{type:e.Inject,args:[E]}]},{type:u.MatDialogRef},{type:a.FormBuilder},{type:s.Store}]},t=T([e.Component({selector:"auth-lib-sign-up",template:'<div id="container">\n    <h2 mat-dialog-title>{{ signUpDialogTitle }}</h2>\n    <form [formGroup]="userForm" (ngSubmit)="onSubmit()">\n\n        <div id="columns">\n            <div id="left-column">\n                <mat-form-field>\n                    <input matInput [placeholder]="usernamePlaceholder" formControlName="username" autocomplete="off">\n                </mat-form-field>\n                <mat-form-field>\n                    <input matInput [placeholder]="firstNamePlaceholder" formControlName="firstName" autocomplete="off">\n                </mat-form-field>\n                <mat-form-field>\n                    <input matInput [placeholder]="emailPlaceholder" formControlName="email" autocomplete="off">\n                </mat-form-field>\n            </div>\n\n            <div id="right-column">\n                <mat-form-field>\n                    <input matInput type="password" [placeholder]="passwordPlaceholder" formControlName="password" autocomplete="off">\n                </mat-form-field>\n                <mat-form-field>\n                    <input matInput [placeholder]="lastNamePlaceholder" formControlName="lastName" autocomplete="off">\n                </mat-form-field>\n                <mat-form-field>\n                    <input matInput [placeholder]="enterprisePlaceholder" formControlName="enterprise" autocomplete="off">\n                </mat-form-field>\n            </div>\n        </div>\n\n        <button mat-raised-button type="submit" [disabled]="userForm.invalid" [ngStyle]="{\n            \'background-color\': buttonsBackgroundColor,\n            \'color\': buttonsColor\n          }">\n            {{ signupButtonTraduction }}\n        </button>\n    </form>\n</div>\n',styles:["#container{display:flex;flex-direction:column;width:600px}#container form{margin-top:20px;display:flex;flex-direction:column;justify-content:space-between}#container form #columns{display:flex;flex-direction:row;justify-content:space-between}#container form #columns #left-column{margin-right:20px}#container form #columns #left-column,#container form #columns #right-column{display:flex;flex-direction:column;justify-content:space-between;width:100%}#container form #columns mat-form-field{width:100%}#container button{margin-top:20px;-ms-grid-row-align:center;align-self:center}"]}),_(0,e.Inject(C)),_(1,e.Inject(E))],t)}(),mt={isAuthenticated:!1,isSignUpLoading:!1,isLoginLoading:!1,user:null,error:null,isPasswordBeingChanged:!1,usersList:null};function gt(e,r){switch(void 0===e&&(e=mt),r.type){case t.AUTH_ACTIONS_TYPE.SIGN_UP:return S(S({},e),{error:null,isSignUpLoading:!0});case t.AUTH_ACTIONS_TYPE.SIGN_UP_FAILURE:return S(S({},e),{error:r.payload,isSignUpLoading:!1});case t.AUTH_ACTIONS_TYPE.SIGN_UP_SUCCESS:return S(S({},e),{error:null,isSignUpLoading:!1});case t.AUTH_ACTIONS_TYPE.LOG_IN:return S(S({},e),{error:null,isLoginLoading:!0});case t.AUTH_ACTIONS_TYPE.LOG_IN_SUCCESS:return S(S({},e),{isAuthenticated:!0,user:r.payload.user,error:null,usersList:r.payload.usersList,isLoginLoading:!1});case t.AUTH_ACTIONS_TYPE.LOG_IN_FAILURE:return S(S({},e),{error:r.payload,isLoginLoading:!1});case t.AUTH_ACTIONS_TYPE.LOG_OUT:return mt;case t.AUTH_ACTIONS_TYPE.LOAD_USER_INFORMATION_SUCCESS:var o=S(S({},e.user),r.payload);return S(S({},e),{user:o});case t.AUTH_ACTIONS_TYPE.CHANGE_PASSWORD:case t.AUTH_ACTIONS_TYPE.SEND_PASSWORD:return S(S({},e),{isPasswordBeingChanged:!0});case t.AUTH_ACTIONS_TYPE.CHANGE_PASSWORD_SUCCESS:case t.AUTH_ACTIONS_TYPE.CHANGE_PASSWORD_FAILURE:case t.AUTH_ACTIONS_TYPE.SEND_PASSWORD_SUCCESS:case t.AUTH_ACTIONS_TYPE.SEND_PASSWORD_FAILURE:return S(S({},e),{isPasswordBeingChanged:!1});case t.AUTH_ACTIONS_TYPE.UPDATE_USER:return S(S({},e),{user:S(S({},e.user),r.payload)});default:return e}}var St=function(){function r(e,r,i,a,u,c,l,p,d){var h=this;this.resetActions=e,this.traductions=r,this.platformId=i,this.actions=a,this.authService=u,this.router=c,this.toastService=l,this.dialog=p,this.store=d,this.OpenSignUpDialog$=this.actions.pipe(f.ofType(t.AUTH_ACTIONS_TYPE.OPEN_SIGN_UP_DIALOG),o.tap((function(){return h.dialogRef=h.dialog.open(ft)}))),this.SignUp$=this.actions.pipe(f.ofType(t.AUTH_ACTIONS_TYPE.SIGN_UP),o.map((function(t){return t.payload})),o.switchMap((function(t){return h.authService.createUser(t).pipe(o.map((function(){return new J})),o.catchError((function(t){return g.of(new K(t))})))}))),this.SignUpSuccess$=this.actions.pipe(f.ofType(t.AUTH_ACTIONS_TYPE.SIGN_UP_SUCCESS),o.tap((function(){h.toastService.success(q(h.traductions||{},"messages.signupSuccess","Your account has been created!"))}))),this.SignUpFailure$=this.actions.pipe(f.ofType(t.AUTH_ACTIONS_TYPE.SIGN_UP_FAILURE),o.tap((function(t){return h.toastService.error(q(h.traductions||{},"messages.signupFailure","Please try again with a new username."))}))),this.LogIn$=this.actions.pipe(f.ofType(t.AUTH_ACTIONS_TYPE.LOG_IN),o.filter((function(t){return n.isPlatformBrowser(h.platformId)})),o.map((function(t){return t.payload})),o.switchMap((function(t){return h.authService.login(t).pipe(o.concatMap((function(t){return sessionStorage.setItem("token",t.token.token),h.authService.getUserInformation().pipe(o.map((function(t){var e=t.user,r=t.usersList;return new X({user:e,usersList:r})})),o.catchError((function(t){return g.of(new Z(t))})))})),o.catchError((function(t){return g.of(new Z(t))})))}))),this.LogInSuccess$=this.actions.pipe(f.ofType(t.AUTH_ACTIONS_TYPE.LOG_IN_SUCCESS),o.filter((function(t){return n.isPlatformBrowser(h.platformId)})),o.withLatestFrom(this.store.pipe(s.select(F))),o.tap((function(t){var e=I(t,2),r=(e[0],e[1]),o=sessionStorage.getItem("redirectedUrlAfterLogIn");o&&n.isPlatformBrowser(h.platformId)?(h.router.navigateByUrl(o),sessionStorage.removeItem("redirectedUrlAfterLogIn")):h.router.navigateByUrl(r.redirectUrlAfterLogin),h.toastService.success(q(h.traductions||{},"messages.loginSuccess","Hi! Nice to see you again!"))}))),this.LogInFailure$=this.actions.pipe(f.ofType(t.AUTH_ACTIONS_TYPE.LOG_IN_FAILURE),o.tap((function(t){return h.toastService.error(q(h.traductions||{},"messages.loginFailure","Wrong credentials. Please check again."))}))),this.LogOut$=this.actions.pipe(f.ofType(t.AUTH_ACTIONS_TYPE.LOG_OUT),o.filter((function(t){return n.isPlatformBrowser(h.platformId)})),o.switchMap((function(t){return sessionStorage.removeItem("token"),h.router.navigate(["log-in"]),(h.resetActions||[]).map((function(t){return new t}))}))),this.LoadUserInformation$=this.actions.pipe(f.ofType(t.AUTH_ACTIONS_TYPE.LOAD_USER_INFORMATION),o.switchMap((function(t){return h.authService.getUserInformation().pipe(o.map((function(t){var e=t.user;t.usersList;return new rt(e)})),o.catchError((function(t){return g.of(new ot(t))})))}))),this.ChangePassword$=this.actions.pipe(f.ofType(t.AUTH_ACTIONS_TYPE.CHANGE_PASSWORD),o.switchMap((function(t){return h.authService.changePassword(t.payload).pipe(o.map((function(){return new it})),o.catchError((function(t){return g.of(new st(t))})))}))),this.ChangePasswordSuccess$=this.actions.pipe(f.ofType(t.AUTH_ACTIONS_TYPE.CHANGE_PASSWORD_SUCCESS),o.tap((function(){return h.toastService.success(q(h.traductions||{},"messages.changePasswordSuccess","Your password has been successfully changed!"))}))),this.ChangePasswordFailure$=this.actions.pipe(f.ofType(t.AUTH_ACTIONS_TYPE.CHANGE_PASSWORD_FAILURE),o.tap((function(t){return h.toastService.error(q(h.traductions||{},"messages.changePasswordFailure","Wrong current password. Please try again."))}))),this.OpenForgottenPasswordDialog$=this.actions.pipe(f.ofType(t.AUTH_ACTIONS_TYPE.OPEN_FORGOTTEN_PASSWORD_DIALOG),o.tap((function(){return h.dialogRef=h.dialog.open(ht)}))),this.SendPassword$=this.actions.pipe(f.ofType(t.AUTH_ACTIONS_TYPE.SEND_PASSWORD),o.tap((function(){h.dialogRef.close()})),o.switchMap((function(t){return h.authService.sendPassword(t.payload).pipe(o.map((function(){return new ct})),o.catchError((function(t){return g.of(new lt(t))})))}))),this.SendPasswordSuccess$=this.actions.pipe(f.ofType(t.AUTH_ACTIONS_TYPE.SEND_PASSWORD_SUCCESS),o.tap((function(){return h.toastService.success(q(h.traductions||{},"messages.passwordResetSuccess","An email for resetting your password has been sent to your address."))}))),this.SendPasswordFailure$=this.actions.pipe(f.ofType(t.AUTH_ACTIONS_TYPE.SEND_PASSWORD_FAILURE),o.tap((function(){return h.toastService.error(q(h.traductions||{},"messages.passwordResetFailure","An error occured. Please try again."))})))}return r.ctorParameters=function(){return[{type:Array,decorators:[{type:e.Inject,args:[O]}]},{type:void 0,decorators:[{type:e.Inject,args:[C]}]},{type:void 0,decorators:[{type:e.Inject,args:[e.PLATFORM_ID]}]},{type:f.Actions},{type:N},{type:i.Router},{type:m.ToastrService},{type:u.MatDialog},{type:s.Store}]},T([f.Effect({dispatch:!1})],r.prototype,"OpenSignUpDialog$",void 0),T([f.Effect()],r.prototype,"SignUp$",void 0),T([f.Effect({dispatch:!1})],r.prototype,"SignUpSuccess$",void 0),T([f.Effect({dispatch:!1})],r.prototype,"SignUpFailure$",void 0),T([f.Effect()],r.prototype,"LogIn$",void 0),T([f.Effect({dispatch:!1})],r.prototype,"LogInSuccess$",void 0),T([f.Effect({dispatch:!1})],r.prototype,"LogInFailure$",void 0),T([f.Effect()],r.prototype,"LogOut$",void 0),T([f.Effect()],r.prototype,"LoadUserInformation$",void 0),T([f.Effect()],r.prototype,"ChangePassword$",void 0),T([f.Effect({dispatch:!1})],r.prototype,"ChangePasswordSuccess$",void 0),T([f.Effect({dispatch:!1})],r.prototype,"ChangePasswordFailure$",void 0),T([f.Effect({dispatch:!1})],r.prototype,"OpenForgottenPasswordDialog$",void 0),T([f.Effect()],r.prototype,"SendPassword$",void 0),T([f.Effect({dispatch:!1})],r.prototype,"SendPasswordSuccess$",void 0),T([f.Effect({dispatch:!1})],r.prototype,"SendPasswordFailure$",void 0),r=T([e.Injectable(),_(0,e.Inject(O)),_(1,e.Inject(C)),_(2,e.Inject(e.PLATFORM_ID))],r)}(),Tt=function(){function t(){}var o;return o=t,t.forRoot=function(t){return{ngModule:o,providers:[{provide:y,useValue:t.urls},{provide:U,useValue:t.images},{provide:C,useValue:t.traductions},{provide:O,useValue:t.resetActions},{provide:E,useValue:t.styles},{provide:r.HTTP_INTERCEPTORS,useClass:W,multi:!0}]}},t=o=T([e.NgModule({declarations:[dt,ht,ft],imports:[n.CommonModule,r.HttpClientModule,i.RouterModule,a.ReactiveFormsModule,s.StoreModule.forFeature("auth",gt),f.EffectsModule.forFeature([St]),h.BrowserAnimationsModule,l.MatCardModule,u.MatDialogModule,p.MatButtonModule,c.MatInputModule,d.MatProgressSpinnerModule,m.ToastrModule.forRoot({timeOut:3e3,positionClass:"toast-bottom-right",preventDuplicates:!0})],entryComponents:[ht],exports:[dt,ht],providers:[$]})],t)}();t.AUTH_API_URLS=y,t.AUTH_IMAGES_URLS=U,t.AUTH_RESET_ACTIONS=O,t.AUTH_STYLES=E,t.AUTH_TRADUCTIONS=C,t.AuthGuard=$,t.AuthModule=Tt,t.AuthService=N,t.ChangePassword=nt,t.ChangePasswordFailure=st,t.ChangePasswordSuccess=it,t.ForgottenPasswordComponent=ht,t.LoadUserInformation=et,t.LoadUserInformationFailure=ot,t.LoadUserInformationSuccess=rt,t.LogIn=Q,t.LogInComponent=dt,t.LogInFailure=Z,t.LogInSuccess=X,t.LogOut=tt,t.OpenForgottenPasswordDialog=at,t.OpenSignUpDialog=V,t.SendPassword=ut,t.SendPasswordFailure=lt,t.SendPasswordSuccess=ct,t.SignUp=z,t.SignUpComponent=ft,t.SignUpFailure=K,t.SignUpSuccess=J,t.TokenInterceptor=W,t.UpdateUser=pt,t.authReducer=gt,t.initialState=mt,t.selectAuthState=w,t.selectIsAuthenticated=L,t.selectIsLoginLoading=M,t.selectIsPasswordBeingChanged=j,t.selectIsSignUpLoading=Y,t.selectLogInError=R,t.selectUser=F,t.selectUsersList=k,t.ɵ0=v,t.ɵ1=b,t.ɵ2=D,t.ɵ3=H,t.ɵ4=x,t.ɵ5=G,t.ɵ6=B,t.ɵa=St,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=angular-auth-lib.umd.min.js.map