!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/common/http"),require("rxjs/operators"),require("@angular/router"),require("@ngrx/store"),require("@angular/forms"),require("lodash"),require("@angular/material/dialog"),require("@angular/common"),require("@angular/material/input"),require("@angular/material/card"),require("@angular/material/button"),require("@angular/material/progress-spinner"),require("@angular/platform-browser/animations"),require("@ngrx/effects"),require("ngx-toastr"),require("rxjs")):"function"==typeof define&&define.amd?define("angular-auth-lib",["exports","@angular/core","@angular/common/http","rxjs/operators","@angular/router","@ngrx/store","@angular/forms","lodash","@angular/material/dialog","@angular/common","@angular/material/input","@angular/material/card","@angular/material/button","@angular/material/progress-spinner","@angular/platform-browser/animations","@ngrx/effects","ngx-toastr","rxjs"],e):e((t=t||self)["angular-auth-lib"]={},t.ng.core,t.ng.common.http,t.rxjs.operators,t.ng.router,t["@ngrx/store"],t.ng.forms,t.lodash,t.ng.material.dialog,t.ng.common,t.ng.material.input,t.ng.material.card,t.ng.material.button,t.ng.material.progressSpinner,t.ng.platformBrowser.animations,t["@ngrx/effects"],t["ngx-toastr"],t.rxjs)}(this,(function(t,e,r,o,n,s,i,a,u,c,l,p,d,h,f,g,m,S){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var T=function(){return(T=Object.assign||function(t){for(var e,r=1,o=arguments.length;r<o;r++)for(var n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)};function _(t,e,r,o){var n,s=arguments.length,i=s<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,r,o);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(i=(s<3?n(i):s>3?n(e,r,i):n(e,r))||i);return s>3&&i&&Object.defineProperty(e,r,i),i}function A(t,e){return function(r,o){e(r,o,t)}}function I(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,s=r.call(t),i=[];try{for(;(void 0===e||e-- >0)&&!(o=s.next()).done;)i.push(o.value)}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return i}var P,y=new e.InjectionToken("Auth api related urls"),U=new e.InjectionToken("Images urls"),C=new e.InjectionToken("Traductions"),E=new e.InjectionToken("Reset actions"),O=new e.InjectionToken("Styling"),N=function(){function t(t,e){this.apiUrls=t,this.http=e}return t.prototype.decodeToken=function(t){var e=t.split(/\./),r=JSON.parse(window.atob(e[1]));return{token:t,expiringDate:new Date(1e3*r.exp)}},t.prototype.getToken=function(){var t=sessionStorage.getItem("token");return t?this.decodeToken(t):null},t.prototype.getAccessToken=function(t){var e=this,r={username:t.username,password:t.password};return this.http.post(this.apiUrls.accessTokenUrl,r).pipe(o.map((function(t){return e.decodeToken(t.access)})))},t.prototype.getRefreshToken=function(t){var e=this,r={refresh:t.token};return this.http.post(this.apiUrls.refreshTokenUrl,r).pipe(o.map((function(t){return e.decodeToken(t.access)})))},t.prototype.login=function(t){return this.getAccessToken(t).pipe(o.map((function(e){return T(T({},t),{token:e})})))},t.prototype.getUserInformation=function(){return this.http.get(this.apiUrls.userInformationUrl).pipe(o.map((function(t){return{usersList:t.usersList,user:T(T({},t.user),{dateJoined:new Date(t.user.dateJoined)})}})))},t.prototype.changePassword=function(t){return this.http.put(this.apiUrls.changePasswordUrl,t)},t.prototype.sendPassword=function(t){return this.http.post(this.apiUrls.sendBackPasswordUrl,{email:t})},t.prototype.createUser=function(t){return this.http.post(this.apiUrls.signUpUrl,t)},t.ctorParameters=function(){return[{type:void 0,decorators:[{type:e.Inject,args:[y]}]},{type:r.HttpClient}]},t.ɵprov=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject(y),e.ɵɵinject(r.HttpClient))},token:t,providedIn:"root"}),t=_([e.Injectable({providedIn:"root"}),A(0,e.Inject(y))],t)}(),w=s.createFeatureSelector("auth"),v=function(t){return t.isAuthenticated},b=s.createSelector(w,v),L=function(t){return t.error},R=s.createSelector(w,L),F=function(t){return t.user},D=s.createSelector(w,F),H=function(t){return t.isPasswordBeingChanged},x=s.createSelector(w,H),k=function(t){return t.usersList},G=s.createSelector(w,k),j=function(t){return t.isSignUpLoading},Y=s.createSelector(w,j),B=function(){function t(t,e){this.store=t,this.router=e}return t.prototype.canActivate=function(t,e){var r=this;return this.store.pipe(s.select(D),o.withLatestFrom(this.store.pipe(s.select(b))),o.map((function(o){var n=I(o,2),s=n[0],i=n[1];return!!(s&&s.allowedUrls.includes(t.routeConfig.path)&&i)||(s&&s.allowedUrls.includes(t.routeConfig.path)&&sessionStorage.setItem("redirectedUrlAfterLogIn",e.url),r.router.navigate(["log-in"]),!1)})))},t.ctorParameters=function(){return[{type:s.Store},{type:n.Router}]},t.ɵprov=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject(s.Store),e.ɵɵinject(n.Router))},token:t,providedIn:"root"}),t=_([e.Injectable({providedIn:"root"})],t)}(),M=function(){function t(t){this.authService=t}return t.prototype.intercept=function(t,e){var r=this.authService.getToken();return r&&(t=t.clone({setHeaders:{Authorization:"Bearer "+r.token}})),e.handle(t)},t.ctorParameters=function(){return[{type:N}]},t=_([e.Injectable()],t)}();(P=t.AUTH_ACTIONS_TYPE||(t.AUTH_ACTIONS_TYPE={})).OPEN_SIGN_UP_DIALOG="[Auth] User wants to sign up",P.SIGN_UP="[Auth] User tries to sign up",P.SIGN_UP_SUCCESS="[Auth] Sign up success",P.SIGN_UP_FAILURE="[Auth] Sign up failure",P.LOG_IN="[Auth] User tries to log in",P.LOG_IN_SUCCESS="[Auth] Log in success",P.LOG_IN_FAILURE="[Auth] Log in failure",P.LOG_OUT="[Auth] User logs out",P.LOAD_USER_INFORMATION="[Auth] Loading of user information",P.LOAD_USER_INFORMATION_SUCCESS="[Auth] Loading of user information success",P.LOAD_USER_INFORMATION_FAILURE="[Auth] Loading of user information failure",P.CHANGE_PASSWORD="[Auth] User changes his password",P.CHANGE_PASSWORD_SUCCESS="[Auth] Password change success",P.CHANGE_PASSWORD_FAILURE="[Auth] Password change failure",P.OPEN_FORGOTTEN_PASSWORD_DIALOG="[Auth] User opens dialog for password resetting",P.SEND_PASSWORD="[Auth] User has asked for having back a new password",P.SEND_PASSWORD_SUCCESS="[Auth] User has received his password",P.SEND_PASSWORD_FAILURE="[Auth] Error in the process of sending the password to the user";var $=function(){this.type=t.AUTH_ACTIONS_TYPE.OPEN_SIGN_UP_DIALOG},W=function(e){this.payload=e,this.type=t.AUTH_ACTIONS_TYPE.SIGN_UP},q=function(){this.type=t.AUTH_ACTIONS_TYPE.SIGN_UP_SUCCESS},V=function(e){this.payload=e,this.type=t.AUTH_ACTIONS_TYPE.SIGN_UP_FAILURE},z=function(e){this.payload=e,this.type=t.AUTH_ACTIONS_TYPE.LOG_IN},J=function(e){this.payload=e,this.type=t.AUTH_ACTIONS_TYPE.LOG_IN_SUCCESS},K=function(e){this.payload=e,this.type=t.AUTH_ACTIONS_TYPE.LOG_IN_FAILURE},Q=function(){this.type=t.AUTH_ACTIONS_TYPE.LOG_OUT},X=function(){this.type=t.AUTH_ACTIONS_TYPE.LOAD_USER_INFORMATION},Z=function(e){this.payload=e,this.type=t.AUTH_ACTIONS_TYPE.LOAD_USER_INFORMATION_SUCCESS},tt=function(e){this.payload=e,this.type=t.AUTH_ACTIONS_TYPE.LOAD_USER_INFORMATION_FAILURE},et=function(e){this.payload=e,this.type=t.AUTH_ACTIONS_TYPE.CHANGE_PASSWORD},rt=function(){this.type=t.AUTH_ACTIONS_TYPE.CHANGE_PASSWORD_SUCCESS},ot=function(e){this.payload=e,this.type=t.AUTH_ACTIONS_TYPE.CHANGE_PASSWORD_FAILURE},nt=function(){this.type=t.AUTH_ACTIONS_TYPE.OPEN_FORGOTTEN_PASSWORD_DIALOG},st=function(e){this.payload=e,this.type=t.AUTH_ACTIONS_TYPE.SEND_PASSWORD},it=function(){this.type=t.AUTH_ACTIONS_TYPE.SEND_PASSWORD_SUCCESS},at=function(e){this.payload=e,this.type=t.AUTH_ACTIONS_TYPE.SEND_PASSWORD_FAILURE},ut=function(){function t(t,e,r,o,n){this.images=t,this.traductions=e,this.styles=r,this.formBuilder=o,this.store=n,this.isPasswordBeingChanged$=this.store.pipe(s.select(x)),this.usernamePlaceholder="Username",this.passwordPlaceholder="Password",this.forgottenPassword="Forgot your password?",this.loginButtonTraduction="Log in",this.buttonsBackgroundColor="#3f51b5",this.buttonsColor="white"}return t.prototype.ngOnInit=function(){this.usernamePlaceholder=a.get(this.traductions||{},"form.usernamePlaceholder",this.usernamePlaceholder),this.passwordPlaceholder=a.get(this.traductions||{},"form.passwordPlaceholder",this.passwordPlaceholder),this.forgottenPassword=a.get(this.traductions||{},"buttons.passwordForgotten",this.forgottenPassword),this.loginButtonTraduction=a.get(this.traductions||{},"buttons.login",this.loginButtonTraduction),this.buttonsBackgroundColor=a.get(this.styles||{},"buttonsBackgroundColor",this.buttonsBackgroundColor),this.buttonsColor=a.get(this.styles||{},"buttonsColor",this.buttonsColor),this.userForm=this.formBuilder.group({username:["",i.Validators.required],password:["",i.Validators.required]})},t.prototype.openDialog=function(){this.store.dispatch(new nt)},t.prototype.onSubmit=function(){var t={username:this.userForm.value.username,password:this.userForm.value.password};this.store.dispatch(new z(t))},t.ctorParameters=function(){return[{type:void 0,decorators:[{type:e.Inject,args:[U]}]},{type:void 0,decorators:[{type:e.Inject,args:[C]}]},{type:void 0,decorators:[{type:e.Inject,args:[O]}]},{type:i.FormBuilder},{type:s.Store}]},t=_([e.Component({selector:"auth-lib-log-in",template:'<div id="container" [ngStyle]="{\'background-image\': \'url(\' + images.loginBackgroundImageUrl + \')\'}">\n  <mat-card class="mat-elevation-z8">\n    <img *ngIf="images.logoImageUrl && images.logoImageUrl.length >= 1" [src]="images.logoImageUrl">\n    <form [formGroup]="userForm" (ngSubmit)="onSubmit()">\n\n      <mat-form-field>\n        <input matInput [placeholder]="usernamePlaceholder" formControlName="username">\n      </mat-form-field>\n\n      <mat-form-field>\n          <input matInput type="password" [placeholder]="passwordPlaceholder" formControlName="password">\n      </mat-form-field>\n\n      <button \n        mat-raised-button\n        type="submit" \n        [disabled]="userForm.invalid"\n        *ngIf="!(isPasswordBeingChanged$ | async)"\n        [ngStyle]="{\n          \'background-color\': buttonsBackgroundColor,\n          \'color\': buttonsColor\n        }"\n      >\n        {{ loginButtonTraduction }}\n      </button>\n      <mat-spinner *ngIf="isPasswordBeingChanged$ | async" [diameter]="36"></mat-spinner>\n\n      <a (click)="openDialog()">{{ forgottenPassword }}</a>\n    </form>\n  </mat-card>\n</div>\n',styles:["#container{display:flex;flex-direction:column;justify-content:center;align-items:center;height:100%;width:100%;flex:1;background-size:cover}#container mat-card{display:flex;flex-direction:column;justify-content:center;align-items:center;height:400px;width:400px;box-sizing:border-box;padding:2%}#container mat-card img{display:block;max-width:200px;max-height:100px;width:auto;height:auto;margin-bottom:20px}#container mat-card form{display:flex;flex:1;flex-direction:column;justify-content:center;align-items:center;width:100%}#container mat-card form mat-form-field{width:75%;font-size:16px}#container mat-card form a,#container mat-card form button,#container mat-card form mat-spinner{margin-top:20px}#container mat-card form a{cursor:pointer;color:#1e90ff;font-size:16px}"]}),A(0,e.Inject(U)),A(1,e.Inject(C)),A(2,e.Inject(O))],t)}(),ct=function(){function t(t,e,r){this.store=t,this.traductions=e,this.styles=r,this.emailPlaceholder="Your email",this.sendButtonTraduction="Send",this.buttonsBackgroundColor="#3f51b5",this.buttonsColor="white"}return t.prototype.ngOnInit=function(){this.emailPlaceholder=a.get(this.traductions||{},"form.emailPlaceholder",this.emailPlaceholder),this.sendButtonTraduction=a.get(this.traductions||{},"buttons.send",this.sendButtonTraduction),this.buttonsBackgroundColor=a.get(this.styles||{},"buttonsBackgroundColor",this.buttonsBackgroundColor),this.buttonsColor=a.get(this.styles||{},"buttonsColor",this.buttonsColor)},t.prototype.send=function(){this.store.dispatch(new st(this.emailInput.nativeElement.value))},t.ctorParameters=function(){return[{type:s.Store},{type:void 0,decorators:[{type:e.Inject,args:[C]}]},{type:void 0,decorators:[{type:e.Inject,args:[O]}]}]},_([e.ViewChild("email")],t.prototype,"emailInput",void 0),t=_([e.Component({selector:"auth-lib-forgotten-password",template:'<mat-form-field>\n  <input matInput [placeholder]="emailPlaceholder" #email>\n</mat-form-field>\n\n<button \n  mat-raised-button\n  type="button" \n  (click)="send()" \n  [disabled]="!(this.emailInput && this.emailInput.nativeElement && this.emailInput.nativeElement.value)"\n  [ngStyle]="{\n    \'background-color\': buttonsBackgroundColor,\n    \'color\': buttonsColor\n  }"\n>\n  {{ sendButtonTraduction }}\n</button>\n',styles:["mat-form-field{font-size:12px;margin-right:30px;width:230px}"]}),A(1,e.Inject(C)),A(2,e.Inject(O))],t)}(),lt=function(){function t(t,e,r,o,n){this.traductions=t,this.styles=e,this.dialogRef=r,this.formBuilder=o,this.store=n,this.usernamePlaceholder="Username",this.passwordPlaceholder="Password",this.firstNamePlaceholder="First name",this.lastNamePlaceholder="Last name",this.emailPlaceholder="Email",this.enterprisePlaceholder="Enterprise",this.signUpDialogTitle="Sign Up",this.signupButtonTraduction="Log in",this.buttonsBackgroundColor="#3f51b5",this.buttonsColor="white"}return t.prototype.ngOnInit=function(){this.usernamePlaceholder=a.get(this.traductions||{},"form.usernamePlaceholder",this.usernamePlaceholder),this.passwordPlaceholder=a.get(this.traductions||{},"form.passwordPlaceholder",this.passwordPlaceholder),this.firstNamePlaceholder=a.get(this.traductions||{},"form.firstNamePlaceholder",this.firstNamePlaceholder),this.lastNamePlaceholder=a.get(this.traductions||{},"form.lastNamePlaceholder",this.lastNamePlaceholder),this.emailPlaceholder=a.get(this.traductions||{},"form.emailPlaceholder",this.emailPlaceholder),this.enterprisePlaceholder=a.get(this.traductions||{},"form.enterprisePlaceholder",this.enterprisePlaceholder),this.signUpDialogTitle=a.get(this.traductions||{},"dialogs.signup",this.signUpDialogTitle),this.signupButtonTraduction=a.get(this.traductions||{},"buttons.signup",this.signupButtonTraduction),this.buttonsBackgroundColor=a.get(this.styles||{},"buttonsBackgroundColor",this.buttonsBackgroundColor),this.buttonsColor=a.get(this.styles||{},"buttonsColor",this.buttonsColor),this.userForm=this.formBuilder.group({username:["",i.Validators.required],password:["",i.Validators.required],firstName:["",i.Validators.required],lastName:["",i.Validators.required],email:["",i.Validators.required],enterprise:""})},t.prototype.onSubmit=function(){var t={username:this.userForm.value.username,password:this.userForm.value.password,firstName:this.userForm.value.firstName,lastName:this.userForm.value.lastName,email:this.userForm.value.email,enterprise:this.userForm.value.enterprise||null};this.store.dispatch(new W(t)),this.dialogRef.close()},t.ctorParameters=function(){return[{type:void 0,decorators:[{type:e.Inject,args:[C]}]},{type:void 0,decorators:[{type:e.Inject,args:[O]}]},{type:u.MatDialogRef},{type:i.FormBuilder},{type:s.Store}]},t=_([e.Component({selector:"auth-lib-sign-up",template:'<div id="container">\n    <h2 mat-dialog-title>{{ signUpDialogTitle }}</h2>\n    <form [formGroup]="userForm" (ngSubmit)="onSubmit()">\n\n        <div id="columns">\n            <div id="left-column">\n                <mat-form-field>\n                    <input matInput [placeholder]="usernamePlaceholder" formControlName="username" autocomplete="off">\n                </mat-form-field>\n                <mat-form-field>\n                    <input matInput [placeholder]="firstNamePlaceholder" formControlName="firstName" autocomplete="off">\n                </mat-form-field>\n                <mat-form-field>\n                    <input matInput [placeholder]="emailPlaceholder" formControlName="email" autocomplete="off">\n                </mat-form-field>\n            </div>\n\n            <div id="right-column">\n                <mat-form-field>\n                    <input matInput type="password" [placeholder]="passwordPlaceholder" formControlName="password" autocomplete="off">\n                </mat-form-field>\n                <mat-form-field>\n                    <input matInput [placeholder]="lastNamePlaceholder" formControlName="lastName" autocomplete="off">\n                </mat-form-field>\n                <mat-form-field>\n                    <input matInput [placeholder]="enterprisePlaceholder" formControlName="enterprise" autocomplete="off">\n                </mat-form-field>\n            </div>\n        </div>\n\n        <button mat-raised-button type="submit" [disabled]="userForm.invalid" [ngStyle]="{\n            \'background-color\': buttonsBackgroundColor,\n            \'color\': buttonsColor\n          }">\n            {{ signupButtonTraduction }}\n        </button>\n    </form>\n</div>\n',styles:["#container{display:flex;flex-direction:column;width:600px}#container form{margin-top:20px;display:flex;flex-direction:column;justify-content:space-between}#container form #columns{display:flex;flex-direction:row;justify-content:space-between}#container form #columns #left-column{margin-right:20px}#container form #columns #left-column,#container form #columns #right-column{display:flex;flex-direction:column;justify-content:space-between;width:100%}#container form #columns mat-form-field{width:100%}#container button{margin-top:20px;-ms-grid-row-align:center;align-self:center}"]}),A(0,e.Inject(C)),A(1,e.Inject(O))],t)}(),pt={isAuthenticated:!1,isSignUpLoading:!1,user:null,error:null,isPasswordBeingChanged:!1,usersList:null};function dt(e,r){switch(void 0===e&&(e=pt),r.type){case t.AUTH_ACTIONS_TYPE.SIGN_UP:return T(T({},e),{error:null,isSignUpLoading:!0});case t.AUTH_ACTIONS_TYPE.SIGN_UP_FAILURE:return T(T({},e),{error:r.payload,isSignUpLoading:!1});case t.AUTH_ACTIONS_TYPE.SIGN_UP_SUCCESS:return T(T({},e),{error:null,isSignUpLoading:!1});case t.AUTH_ACTIONS_TYPE.LOG_IN_SUCCESS:return T(T({},e),{isAuthenticated:!0,user:r.payload.user,error:null,usersList:r.payload.usersList});case t.AUTH_ACTIONS_TYPE.LOG_IN_FAILURE:return T(T({},e),{error:r.payload});case t.AUTH_ACTIONS_TYPE.LOG_OUT:return pt;case t.AUTH_ACTIONS_TYPE.LOAD_USER_INFORMATION_SUCCESS:var o=T(T({},e.user),r.payload);return T(T({},e),{user:o});case t.AUTH_ACTIONS_TYPE.CHANGE_PASSWORD:case t.AUTH_ACTIONS_TYPE.SEND_PASSWORD:return T(T({},e),{isPasswordBeingChanged:!0});case t.AUTH_ACTIONS_TYPE.CHANGE_PASSWORD_SUCCESS:case t.AUTH_ACTIONS_TYPE.CHANGE_PASSWORD_FAILURE:case t.AUTH_ACTIONS_TYPE.SEND_PASSWORD_SUCCESS:case t.AUTH_ACTIONS_TYPE.SEND_PASSWORD_FAILURE:return T(T({},e),{isPasswordBeingChanged:!1});default:return e}}var ht=function(){function r(e,r,n,i,u,c,l,p){var d=this;this.resetActions=e,this.traductions=r,this.actions=n,this.authService=i,this.router=u,this.toastService=c,this.dialog=l,this.store=p,this.OpenSignUpDialog$=this.actions.pipe(g.ofType(t.AUTH_ACTIONS_TYPE.OPEN_SIGN_UP_DIALOG),o.tap((function(){return d.dialogRef=d.dialog.open(lt)}))),this.SignUp$=this.actions.pipe(g.ofType(t.AUTH_ACTIONS_TYPE.SIGN_UP),o.map((function(t){return t.payload})),o.switchMap((function(t){return d.authService.createUser(t).pipe(o.map((function(){return new q})),o.catchError((function(t){return S.of(new V(t))})))}))),this.SignUpSuccess$=this.actions.pipe(g.ofType(t.AUTH_ACTIONS_TYPE.SIGN_UP_SUCCESS),o.tap((function(){d.toastService.success(a.get(d.traductions||{},"messages.signupSuccess","Your account has been created!"))}))),this.SignUpFailure$=this.actions.pipe(g.ofType(t.AUTH_ACTIONS_TYPE.SIGN_UP_FAILURE),o.tap((function(t){return d.toastService.error(a.get(d.traductions||{},"messages.signupFailure","Please try again with a new username."))}))),this.LogIn$=this.actions.pipe(g.ofType(t.AUTH_ACTIONS_TYPE.LOG_IN),o.map((function(t){return t.payload})),o.switchMap((function(t){return d.authService.login(t).pipe(o.concatMap((function(t){return sessionStorage.setItem("token",t.token.token),d.authService.getUserInformation().pipe(o.map((function(t){var e=t.user,r=t.usersList;return new J({user:e,usersList:r})})),o.catchError((function(t){return S.of(new K(t))})))})),o.catchError((function(t){return S.of(new K(t))})))}))),this.LogInSuccess$=this.actions.pipe(g.ofType(t.AUTH_ACTIONS_TYPE.LOG_IN_SUCCESS),o.withLatestFrom(this.store.pipe(s.select(D))),o.tap((function(t){var e=I(t,2),r=(e[0],e[1]),o=sessionStorage.getItem("redirectedUrlAfterLogIn");o?(d.router.navigateByUrl(o),sessionStorage.removeItem("redirectedUrlAfterLogIn")):d.router.navigateByUrl(r.redirectUrlAfterLogin),d.toastService.success(a.get(d.traductions||{},"messages.loginSuccess","Hi! Nice to see you again!"))}))),this.LogInFailure$=this.actions.pipe(g.ofType(t.AUTH_ACTIONS_TYPE.LOG_IN_FAILURE),o.tap((function(t){return d.toastService.error(a.get(d.traductions||{},"messages.loginFailure","Wrong credentials. Please check again."))}))),this.LogOut$=this.actions.pipe(g.ofType(t.AUTH_ACTIONS_TYPE.LOG_OUT),o.switchMap((function(t){return sessionStorage.removeItem("token"),d.router.navigate(["log-in"]),(d.resetActions||[]).map((function(t){return new t}))}))),this.LoadUserInformation$=this.actions.pipe(g.ofType(t.AUTH_ACTIONS_TYPE.LOAD_USER_INFORMATION),o.switchMap((function(t){return d.authService.getUserInformation().pipe(o.map((function(t){var e=t.user;t.usersList;return new Z(e)})),o.catchError((function(t){return S.of(new tt(t))})))}))),this.ChangePassword$=this.actions.pipe(g.ofType(t.AUTH_ACTIONS_TYPE.CHANGE_PASSWORD),o.switchMap((function(t){return d.authService.changePassword(t.payload).pipe(o.map((function(){return new rt})),o.catchError((function(t){return S.of(new ot(t))})))}))),this.ChangePasswordSuccess$=this.actions.pipe(g.ofType(t.AUTH_ACTIONS_TYPE.CHANGE_PASSWORD_SUCCESS),o.tap((function(){return d.toastService.success(a.get(d.traductions||{},"messages.changePasswordSuccess","Your password has been successfully changed!"))}))),this.ChangePasswordFailure$=this.actions.pipe(g.ofType(t.AUTH_ACTIONS_TYPE.CHANGE_PASSWORD_FAILURE),o.tap((function(t){return d.toastService.error(a.get(d.traductions||{},"messages.changePasswordFailure","Wrong current password. Please try again."))}))),this.OpenForgottenPasswordDialog$=this.actions.pipe(g.ofType(t.AUTH_ACTIONS_TYPE.OPEN_FORGOTTEN_PASSWORD_DIALOG),o.tap((function(){return d.dialogRef=d.dialog.open(ct)}))),this.SendPassword$=this.actions.pipe(g.ofType(t.AUTH_ACTIONS_TYPE.SEND_PASSWORD),o.tap((function(){d.dialogRef.close()})),o.switchMap((function(t){return d.authService.sendPassword(t.payload).pipe(o.map((function(){return new it})),o.catchError((function(t){return S.of(new at(t))})))}))),this.SendPasswordSuccess$=this.actions.pipe(g.ofType(t.AUTH_ACTIONS_TYPE.SEND_PASSWORD_SUCCESS),o.tap((function(){return d.toastService.success(a.get(d.traductions||{},"messages.passwordResetSuccess","An email for resetting your password has been sent to your address."))}))),this.SendPasswordFailure$=this.actions.pipe(g.ofType(t.AUTH_ACTIONS_TYPE.SEND_PASSWORD_FAILURE),o.tap((function(){return d.toastService.error(a.get(d.traductions||{},"messages.passwordResetFailure","An error occured. Please try again."))})))}return r.ctorParameters=function(){return[{type:Array,decorators:[{type:e.Inject,args:[E]}]},{type:void 0,decorators:[{type:e.Inject,args:[C]}]},{type:g.Actions},{type:N},{type:n.Router},{type:m.ToastrService},{type:u.MatDialog},{type:s.Store}]},_([g.Effect({dispatch:!1})],r.prototype,"OpenSignUpDialog$",void 0),_([g.Effect()],r.prototype,"SignUp$",void 0),_([g.Effect({dispatch:!1})],r.prototype,"SignUpSuccess$",void 0),_([g.Effect({dispatch:!1})],r.prototype,"SignUpFailure$",void 0),_([g.Effect()],r.prototype,"LogIn$",void 0),_([g.Effect({dispatch:!1})],r.prototype,"LogInSuccess$",void 0),_([g.Effect({dispatch:!1})],r.prototype,"LogInFailure$",void 0),_([g.Effect()],r.prototype,"LogOut$",void 0),_([g.Effect()],r.prototype,"LoadUserInformation$",void 0),_([g.Effect()],r.prototype,"ChangePassword$",void 0),_([g.Effect({dispatch:!1})],r.prototype,"ChangePasswordSuccess$",void 0),_([g.Effect({dispatch:!1})],r.prototype,"ChangePasswordFailure$",void 0),_([g.Effect({dispatch:!1})],r.prototype,"OpenForgottenPasswordDialog$",void 0),_([g.Effect()],r.prototype,"SendPassword$",void 0),_([g.Effect({dispatch:!1})],r.prototype,"SendPasswordSuccess$",void 0),_([g.Effect({dispatch:!1})],r.prototype,"SendPasswordFailure$",void 0),r=_([e.Injectable(),A(0,e.Inject(E)),A(1,e.Inject(C))],r)}(),ft=function(){function t(){}var o;return o=t,t.forRoot=function(t){return{ngModule:o,providers:[{provide:y,useValue:t.urls},{provide:U,useValue:t.images},{provide:C,useValue:t.traductions},{provide:E,useValue:t.resetActions},{provide:O,useValue:t.styles},{provide:r.HTTP_INTERCEPTORS,useClass:M,multi:!0}]}},t=o=_([e.NgModule({declarations:[ut,ct,lt],imports:[c.CommonModule,r.HttpClientModule,n.RouterModule,i.ReactiveFormsModule,s.StoreModule.forFeature("auth",dt),g.EffectsModule.forFeature([ht]),f.BrowserAnimationsModule,p.MatCardModule,u.MatDialogModule,d.MatButtonModule,l.MatInputModule,h.MatProgressSpinnerModule,m.ToastrModule.forRoot({timeOut:3e3,positionClass:"toast-bottom-right",preventDuplicates:!0})],entryComponents:[ct],exports:[ut,ct],providers:[B]})],t)}();t.AUTH_API_URLS=y,t.AUTH_IMAGES_URLS=U,t.AUTH_RESET_ACTIONS=E,t.AUTH_STYLES=O,t.AUTH_TRADUCTIONS=C,t.AuthGuard=B,t.AuthModule=ft,t.AuthService=N,t.ChangePassword=et,t.ChangePasswordFailure=ot,t.ChangePasswordSuccess=rt,t.ForgottenPasswordComponent=ct,t.LoadUserInformation=X,t.LoadUserInformationFailure=tt,t.LoadUserInformationSuccess=Z,t.LogIn=z,t.LogInComponent=ut,t.LogInFailure=K,t.LogInSuccess=J,t.LogOut=Q,t.OpenForgottenPasswordDialog=nt,t.OpenSignUpDialog=$,t.SendPassword=st,t.SendPasswordFailure=at,t.SendPasswordSuccess=it,t.SignUp=W,t.SignUpComponent=lt,t.SignUpFailure=V,t.SignUpSuccess=q,t.TokenInterceptor=M,t.authReducer=dt,t.initialState=pt,t.selectAuthState=w,t.selectIsAuthenticated=b,t.selectIsPasswordBeingChanged=x,t.selectIsSignUpLoading=Y,t.selectLogInError=R,t.selectUser=D,t.selectUsersList=G,t.ɵ0=v,t.ɵ1=L,t.ɵ2=F,t.ɵ3=H,t.ɵ4=k,t.ɵ5=j,t.ɵa=ht,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=angular-auth-lib.umd.min.js.map